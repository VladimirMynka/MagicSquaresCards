```md
# Определение магического квадрата
### Info type
1_Main
### Keywords
~Главное1Определение, ~магические квадраты, ~магическая константа
### Text
Магические квадраты – это таблички с цифрами, характеризующиеся одним свойством: сумма чисел во всех строках, столбцах и диагоналях равна одному и тому же числу. Это число называется магической константой.
```
```md
# Пример магического квадрата
### Info type
1_Main
### Keywords
~Главное2Пример, ~магические квадраты, ~магическая константа, ~пример магического квадрата 3 на 3
### Text
Пример магического квадрата 3 на 3:
$$
\begin{matrix}
8 & 3 & 4 \\
1 & 5 & 9 \\
6 & 7 & 2
\end{matrix}
$$
Для этого квадрата выполняется система уравнений:
$$8+3+4=1+5+9=6+7+2=15$$
$$8+1+6=3+5+7=4+9+2=15$$
$$8+5+2=4+5+6=15$$
15, в данном случае – магическая константа.
```
```md
# Определение квадратного магического квадрата
### Info type
1_Main
### Keywords
~Главное3Определение, ~магические квадраты, ~квадратный магический квадрат, ~проблема квадратного квадрата
### Text
Открытой проблемой математики остаётся вопрос существования магического квадрата, все элементы которого – полные квадраты различных натуральных чисел. Мы будем в шутку называть такие магические квадраты квадратными, для простоты речи.
```
```md
# АВС-модель магического квадрата
### Info type
1_Main
### Keywords
~Алгебра1Модель, ~магические квадраты, ~АВС-модель, ~алгебра
### Text
Простейшим вариантом представления магического квадрата в общем виде служит таблица из девяти букв, в дальнейшем называемая АВС-моделью:
$$
\begin{matrix}
A & B & C \\
D & E & F \\
G & H & J
\end{matrix}
$$
Для квадратного квадрата под АВС-моделью подразумевается квадрат
$$
\begin{matrix}
A^2 & B^2 & C^2 \\
D^2 & E^2 & F^2 \\
G^2 & H^2 & J^2
\end{matrix}
$$
То есть, в зависимости от контекста, эти буквы могут обозначать либо сами элементы квадрата, либо их квадратные корни.
```
```md
# Теорема о магической константе
### Info type
1_Main
### Keywords
~Алгебра2Теорема, ~магические квадраты, ~магическая константа, ~теорема
### Text
Теорема 1. Магическая константа любого магического квадрата равна 3E.
### Approves
~~Алгебра2Доказательство
```
```md
# Доказательство теоремы о магической константе
### Info type
7_Approvement
### Keywords
~Алгебра2Доказательство, ~магические квадраты, ~магическая константа, ~теорема, ~доказательство
### Approves
~~Алгебра2Теорема
### Text
Доказательство. Обозначим магическую константу за M, а сумму A+J за N. Тогда M = N + E. Заметим теперь, что A+E+J=B+E+H=C+E+G = N + E. Вычитая отовсюду E, получим A+J=B+H=C+G=N. Сумма A+B+C+G+H+J может быть записана, с одной стороны, как 2M, а с другой стороны, как 3N.
M = N + E
3M = 3N + 3E
3M = 2M + 3E
M = 3E
```
```md
# Теорема о трёх числах
### Info type
1_Main
### Keywords
~Алгебра3Теорема, ~магические квадраты, ~теорема, ~каноническая модель
### Text
Теорема 2. Любой магический квадрат может быть описан тремя числами.
### Approves
~~Алгебра3Доказательство
```
```md
# Доказательство теоремы о трёх числах
### Info type
7_Approvement
### Keywords
~Алгебра3Доказательство, ~магические квадраты, ~теорема, ~каноническая модель, ~доказательство
### Approves
~~Алгебра3Теорема
### Text
Доказательство. Обозначим x = A-E, y = G-E. Тогда, очевидно, A = E+x, G = E+y. Из теоремы 1 выразим: J = E-x, C = E-y. И, применяя теорему 1 ещё раз, получим: B = E-x+y, H = E+x-y, D = E-x-y, F = E+x+y. Линейная независимость E, x, y доказывается из системы уравнений, задающих магический квадрат методами линейной алгебры.
```
```md
# Каноническая модель магического квадрата
### Info type
1_Main
### Keywords
~Алгебра4Модель, ~магические квадраты, ~каноническая модель, ~алгебра
### Text
Теорема 2, и в частности предложенное нами доказательство, порождает новую модель магического квадрата, называемую канонической:
$$
\begin{matrix}
E+x & E-x+y & E-y \\
E-x-y & E & E+x+y \\
E+y & E+x-y & E-x
\end{matrix}
$$
Каноническая модель для квадратного квадрата записывается так:
$$
\begin{matrix}
E^2 + x & E^2-x+y & E^2 - y \\
E^2-x-y & E^2 & E^2+x+y \\
E^2+y & E^2+x-y & E^2-x
\end{matrix}
$$
В отличие от АВС-модели, каноническая модель содержит лишь линейно независимые переменные. То есть существует биекция между множеством магических квадратов и тройками чисел E, x, y.
```
```md
# Определение изоморфных магических квадратов
### Info type
1_Main
### Keywords
~Алгебра5Определение, ~магические квадраты, ~изоморфизм
### Text
Магические квадраты, получаемые из данного поворотом/отражением и любой комбинацией этих действий, будем называть изоморфными данному.
```
```md
# Лемма об ограничениях канонической модели
### Info type
1_Main
### Keywords
~Алгебра6Лемма, ~магические квадраты, ~каноническая модель, ~ограничение, ~лемма
### Text
Лемма 1 (Бубса и Мумса). Для квадратного квадрата, записанного в каноническом виде при условии y > x > 0 выполняется система неравенств:
$$0 < E^2 - x - y < E^2 - y < \{E^2 - x, E^2 + x - y\} < E^2 < \{E^2 - x + y, E^2 + x\} < E^2 + y < E^2 + x + y < 2E^2$$
или, в АВС-модели:
$$0 < D < C < \{J, H\} < E < \{B, A\} <G < F < E\sqrt{2}$$
Примеч. В фигурные скобки заключены элементы, находящиеся в одинаковом отношении с другими элементами, и в неопределённом отношении друг с другом.
```
```md
# Следствие из леммы об ограничениях
### Info type
1_Main
### Keywords
~Алгебра7Следствие, ~магические квадраты, ~каноническая модель, ~ограничение, ~лемма
### Text
Лемма напрямую вытекает из наложенного нами условия, а также из того факта, что все квадраты натуральных чисел положительны. Вообще говоря, все потенциально существующие квадратные квадраты можно разделить на две группы:
1. $x \in (0, \frac{y}{2})$
2. $x \in (\frac{y}{2}, y)$
```
```md
# Магический квадрат как матрица
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра8Матрица, ~магические квадраты, ~матрица, ~векторное пространство
### Text
Биекция между магическими квадратами и тройками чисел E, x, y позволяет ввести сокращённую запись m(E, x, y). Этой записью мы будем обозначать матрицы вида
$$
\begin{matrix}
E+x & E-x+y & E-y \\
E-x-y & E & E+x+y \\
E+y & E+x-y & E-x
\end{matrix}
$$
Несложно заметить, что множество таких матриц образует векторное пространство:
$$m(E_1, x_1, y_1) + m(E_2, x_2, y_2) = m(E_1 + E_2, x_1 + x_2, y_1 + y_2)$$
$$\lambda m(E, x, y) = m(\lambda E, \lambda x, \lambda y)$$
```
```md
# Изоморфизмы магического квадрата в матричном виде
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра9Изоморфизмы, ~магические квадраты, ~матрица, ~изоморфизм
### Text
В данной записи мы можем записать все существующие изоморфизмы квадрата:
*   m(E, x, y) — исходный квадрат
*   m(E, x, -y) — отражение относительно главной диагонали [транспонирование]
*   m(E, -x, y) — отражение относительно побочной диагонали
*   m(E, -x, -y) — поворот на 180°
*   m(E, y, x) — отражение относительно средней горизонтали
*   m(E, y, -x) — поворот на 90° по часовой стрелке
*   m(E, -y, x) — поворот на 90° против часовой стрелки
*   m(E, -x, -y) — отражение относительно средней вертикали
И ещё одна операция, унаследованная магическими квадратами от матриц — взятие определителя.
$$det(m(E, x, y)) = 9E(x^2 - y^2)$$
```
```md
# Базис векторного пространства магических квадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра10Базис, ~магические квадраты, ~матрица, ~векторное пространство
### Text
Векторное пространство даёт нам возможность ввести базисный подход. Наиболее удобными базисными квадратами для нас являются m(1,0,0), m(0,1,0) и m(0,0,1):
$$m(1,0,0) = \begin{pmatrix} 1 & 1 & 1 \\ 1 & 1 & 1 \\ 1 & 1 & 1 \end{pmatrix}$$
$$m(0,1,0) = \begin{pmatrix} 1 & -1 & 0 \\ -1 & 0 & 1 \\ 0 & 1 & -1 \end{pmatrix}$$
$$m(0,0,1) = \begin{pmatrix} 0 & 1 & -1 \\ 1 & 0 & -1 \\ -1 & 1 & 0 \end{pmatrix}$$
$$m(E, x, y) = Em(1,0,0) + xm(0,1,0) + ym(0,0,1)$$
Заметим, при этом, на всякий случай, что Em(1,0,0) + xm(0,1,0) — симметричная часть матрицы, а ym(0,0,1) — антисимметричная.
```
```md
# Коллинеарные магические квадраты
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра11Коллинеарность, ~магические квадраты, ~матрица, ~векторное пространство
### Text
Также, имея векторное пространство, мы можем говорить о коллинеарных квадратах: квадратах, получаемых друг из друга домножением на коэффициент. Коллинеарные квадраты инвариантны относительно многих свойств. Так, например, если квадрат m(E², x, y) является квадратным, то и квадрат a²m(E², x, y) также квадратный. А значит, имеет смысл рассматривать лишь минимальный квадрат, то есть тот, в котором нельзя вынести общий множитель.
```
```md
# Базисные квадраты для произведения
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра12Умножение, ~магические квадраты, ~матрица, ~умножение
### Text
Для удобства обозначим базисные квадраты следующим образом:
$$s_0 = m(1,0,0)$$
$$s_1 = m(0,1,0)$$
$$s_2 = m(0,0,1)$$
```
```md
# Дистрибутивность умножения магических квадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра13Умножение, ~магические квадраты, ~матрица, ~умножение
### Text
Далее воспользуемся общим для всех матриц свойством дистрибутивности умножения относительно сложения:
$$m(E_1,x_1,y_1) \cdot m(E_2,x_2,y_2) = (E_1s_0 + x_1s_1 + y_1s_2) \cdot (E_2s_0 + x_2s_1 + y_2s_2) =$$
$$= E_1E_2s_0^2 + E_1x_2s_0s_1 + E_1y_2s_0s_2 + x_1E_2s_1s_0 + x_1x_2s_1^2 + x_1y_2s_1s_2 + y_1E_2s_2s_0 + y_1x_2s_2s_1 + y_1y_2s_2^2$$
Отметим теперь, что умножение любой матрицы A на матрицу s_0 есть матрица, составленная из сумм строк/столбцов матрицы A. Поскольку суммы каждой из строк и столбцов матриц s_1 и s_2 равны нулю, то $s_0s_1 = s_1s_0 = s_0s_2 = s_2s_0 = 0$, где 0 - нулевая матрица. Поэтому мы можем записать:
$$m(E_1,x_1,y_1) \cdot m(E_2,x_2,y_2) = E_1E_2s_0^2 + x_1x_2s_1^2 + x_1y_2s_1s_2 + y_1x_2s_2s_1 + y_1y_2s_2^2$$
```
```md
# Произведения базисных квадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра14Произведение, ~магические квадраты, ~матрица, ~умножение
### Text
Рассчитаем эти пять произведений базисных квадратов:
$$s_0s_0 = \begin{pmatrix} 1 & 1 & 1 \\ 1 & 1 & 1 \\ 1 & 1 & 1 \end{pmatrix} \begin{pmatrix} 1 & 1 & 1 \\ 1 & 1 & 1 \\ 1 & 1 & 1 \end{pmatrix} = \begin{pmatrix} 3 & 3 & 3 \\ 3 & 3 & 3 \\ 3 & 3 & 3 \end{pmatrix}$$
$$s_1s_1 = \begin{pmatrix} 1 & -1 & 0 \\ -1 & 0 & 1 \\ 0 & 1 & -1 \end{pmatrix} \begin{pmatrix} 1 & -1 & 0 \\ -1 & 0 & 1 \\ 0 & 1 & -1 \end{pmatrix} = \begin{pmatrix} 2 & -1 & -1 \\ -1 & 2 & -1 \\ -1 & -1 & 2 \end{pmatrix}$$
$$s_1s_2 = \begin{pmatrix} 1 & -1 & 0 \\ -1 & 0 & 1 \\ 0 & 1 & -1 \end{pmatrix} \begin{pmatrix} 0 & 1 & -1 \\ 1 & 0 & -1 \\ -1 & 1 & 0 \end{pmatrix} = \begin{pmatrix} -1 & 1 & -2 \\ -1 & -1 & 2 \\ 2 & -1 & -1 \end{pmatrix}$$
$$s_2s_1 = \begin{pmatrix} 0 & 1 & -1 \\ 1 & 0 & -1 \\ -1 & 1 & 0 \end{pmatrix} \begin{pmatrix} 1 & -1 & 0 \\ -1 & 0 & 1 \\ 0 & 1 & -1 \end{pmatrix} = \begin{pmatrix} -1 & -1 & 2 \\ 1 & -2 & 1 \\ 1 & 1 & -2 \end{pmatrix}$$
$$s_2s_2 = \begin{pmatrix} 0 & 1 & -1 \\ 1 & 0 & -1 \\ -1 & 1 & 0 \end{pmatrix} \begin{pmatrix} 0 & 1 & -1 \\ 1 & 0 & -1 \\ -1 & 1 & 0 \end{pmatrix} = \begin{pmatrix} 2 & -1 & -1 \\ -1 & 2 & -1 \\ -1 & -1 & 2 \end{pmatrix}$$
```
```md
# Чарующие квадраты
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра15Чарующие, ~магические квадраты, ~матрица, ~умножение
### Text
Обозначим теперь $s_3 = s_1s_1, s_4 = s_2s_1$. Тогда, возвращаясь к вычислениям, получим
$$m(E_1, x_1, y_1) \cdot m(E_2, x_2, y_2) = 3E_1E_2s_0 + (x_1x_2 - y_1y_2)s_3 + (y_1x_2 - x_1y_2)s_4$$
Назовём матрицы, построенные из трёх базисных матриц $s_0, s_3, s_4$, чарующими квадратами, и будем обозначать, по аналогии с магическими, $c(E, x, y) = Es_0 + xs_3 + ys_4$
Это матрицы вида
$$
\begin{matrix}
E+2x-y & E-x-y & E-x+2y \\
E-x-y & E+2x+2y & E-x-y \\
E-x+2y & E-x-y & E+2x-y
\end{matrix}
$$
```
```md
# Первое правило умножения квадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра16Умножение, ~магические квадраты, ~матрица, ~умножение
### Text
В чём же значимость этих матриц для нас? Выше мы записали Первое правило умножения квадратов. Повторим его в несколько ином виде:
$$m(E_1, x_1, y_1) \cdot m(E_2, x_2, y_2) = c(3E_1E_2, x_1x_2 - y_1y_2, y_1x_2 - x_1y_2)$$
```
```md
# Правила умножения квадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра17Правила, ~магические квадраты, ~матрица, ~умножение
### Text
Помимо Первого, есть также Второе, Третье и Четвёртое правила умножения квадратов, получаемые тем же образом:
$$m(E_1, x_1, y_1) \cdot c(E_2, x_2, y_2) = 3m(E_1E_2, x_1x_2 - y_1y_2, y_1x_2 - x_1y_2)$$
$$c(E_1, x_1, y_1) \cdot m(E_2, x_2, y_2) = 3m(E_1E_2, x_1x_2 + y_1y_2, y_1x_2 + x_1y_2)$$
$$c(E_1, x_1, y_1) \cdot c(E_2, x_2, y_2) = 3c(E_1E_2, x_1x_2 + y_1y_2, y_1x_2 + x_1y_2)$$
```
```md
# Коммутативность магических квадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра18Коммутативность, ~магические квадраты, ~матрица, ~умножение
### Text
Комбинация первого и второго правила, или первого и третьего, доказывает очень интересный факт: произведение нечётного количества магических квадратов даёт магический квадрат, причём квадраты в произведении, имеющие одинаковую чётность, коммутируют.
```
```md
# Нейтральный элемент для чарующих квадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра19Нейтральный, ~магические квадраты, ~матрица, ~умножение
### Text
Очень нам везёт, когда мы замечаем, что единичная матрица — нейтральный элемент относительно матричного умножения [и, соответственно, умножения квадратов], входит во множество чарующих квадратов:
$$m(E, x, y) \cdot c(\frac{1}{3}, \frac{1}{3}, 0) = c(\frac{1}{3}, \frac{1}{3}, 0) \cdot m(E, x, y) = m(E, x, y)$$
$$c(E, x, y) \cdot c(\frac{1}{3}, \frac{1}{3}, 0) = c(\frac{1}{3}, \frac{1}{3}, 0) \cdot c(E, x, y) = c(E, x, y)$$
```
```md
# Обратные элементы
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра20Обратные, ~магические квадраты, ~матрица, ~умножение
### Text
Наличие нейтрального элемента во множестве чарующих квадратов указывает на то, что обратные элементы также принадлежат соответствующим множествам. Так, решим уравнение
$$m(E, x, y) \cdot m(F, z, w) = c(\frac{1}{3}, \frac{1}{3}, 0)$$
относительно F, z, w. В соответствии с Первым правилом умножения, данное уравнение эквивалентно системе
$$\frac{1}{3} = 3EF$$
$$0 = xz - yw$$
$$0 = yz - xw$$
Откуда следует
$$m^{-1}(E, x, y) = m(\frac{1}{9E}, \frac{x}{3(x^2 - y^2)}, \frac{-y}{3(x^2 - y^2)})$$
Причём из курса линейной алгебры известно, что перемножение обратных матриц коммутативно, а значит не имеет значения, с какой стороны умножать на обратную матрицу. Другой способ записать обратную матрицу:
$$m^{-1}(E, x, y) = \frac{m(x^2 - y^2, 3Ex, 3Ey)}{det(m(E, x, y))}$$
Аналогично выводится и матрица, обратная к чарующему квадрату:
$$c^{-1}(E, x, y) = \frac{3c(x^2 - y^2, Ex, -Ey)}{det(c(E, x, y))}$$
```
```md
# Уравнения в магических квадратах
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра21Уравнения, ~магические квадраты, ~матрица, ~умножение
### Text
Наличие обратного элемента в рассматриваемом множестве позволяет решать уравнения в магических квадратах. Автор данного материала надеется, что с помощью свойств умножения получится записать квадратный квадрат в виде произведения более простых магических квадратов. Пока же не остаётся ничего, кроме как собирать разного рода информацию.
```
```md
# Определение полумагического квадрата
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра22Полумагические, ~магические квадраты, ~полумагический квадрат, ~алгебра
### Text
Полумагическим квадратом называют квадратную таблицу, заполненную числами таким образом, что сумма чисел в каждой строке и в каждом столбце равна определённому числу:
$$
\begin{matrix}
a_1 & a_2 & a_3 \\
a_1 & a_2 & a_3 \\
a_1 & a_2 & a_3
\end{matrix}
\Leftrightarrow
\begin{matrix}
a_1^2 & a_2^2 & a_3^2 \\
a_1^2 & a_2^2 & a_3^2 \\
a_1^2 & a_2^2 & a_3^2
\end{matrix}
— полумагический
$$
$$
\begin{matrix}
a_1^2 + a_2^2 + a_3^2 = C \\
a_1^2 + a_2^2 + a_3^2 = C \\
a_1^2 + a_2^2 + a_3^2 = C
\end{matrix}
$$
$$
\begin{matrix}
a_1^2 + a_1^2 + a_1^2 = C \\
a_2^2 + a_2^2 + a_2^2 = C \\
a_3^2 + a_3^2 + a_3^2 = C
\end{matrix}
$$
```
```md
# Векторное пространство полумагических квадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра23Полумагические, ~магические квадраты, ~полумагический квадрат, ~алгебра, ~векторное пространство
### Text
Вполне очевидно, что на множестве полумагических квадратов также существует векторное пространство. Решая систему, задающую полумагический квадрат, получим, что это пространство имеет размерность 5. Заметим теперь, что $s_0, s_1, s_2, s_3, s_4$ независимые полумагические квадраты, любая линейная комбинация которых — также полумагический квадрат. Множество всех линейных комбинаций названных квадратов является подпространством полумагических квадратов, при этом их размерности совпадают. Это значит, что данные векторные пространства совпадают.
Это значит, что имеем дело с алгеброй. Таблица умножения базисных квадратов:
$$
\begin{matrix}
\times & s_0 & s_1 & s_2 & s_3 & s_4 \\
s_0 & 3s_0 & 0 & 0 & 0 & 0 \\
s_1 & 0 & 0 & s_3 & -s_4 & 3s_1-3s_2 \\
s_2 & 0 & 0 & s_4 & -s_3 & 3s_2-3s_1 \\
s_3 & 0 & 3s_1 & 3s_2 & 3s_3 & 3s_4 \\
s_4 & 0 & 3s_2 & 3s_1 & 3s_4 & 3s_3
\end{matrix}
$$
```
```md
# Другой базис полумагических квадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра24Полумагические, ~магические квадраты, ~полумагический квадрат, ~алгебра, ~векторное пространство
### Text
Если же мы перезададим базисы следующим образом:
$$s_0 = \frac{1}{3} \begin{pmatrix} 1 & 1 & 1 \\ 1 & 1 & 1 \\ 1 & 1 & 1 \end{pmatrix}$$
$$s_1 = \frac{1}{3} \begin{pmatrix} 2 & -1 & -1 \\ -1 & 2 & -1 \\ -1 & -1 & 2 \end{pmatrix}$$
$$s_2 = \frac{1}{3} \begin{pmatrix} -1 & -1 & 2 \\ -1 & 2 & -1 \\ 2 & -1 & -1 \end{pmatrix}$$
$$s_3 = \frac{1}{\sqrt{3}} \begin{pmatrix} 1 & -1 & 0 \\ -1 & 0 & 1 \\ 0 & 1 & -1 \end{pmatrix}$$
$$s_4 = \frac{1}{\sqrt{3}} \begin{pmatrix} 0 & 1 & -1 \\ 1 & 0 & -1 \\ -1 & 1 & 0 \end{pmatrix}$$
То таблица умножения будет выглядеть чуть более приятно:
$$
\begin{matrix}
\times & s_0 & s_1 & s_2 & s_3 & s_4 \\
s_0 & s_0 & 0 & 0 & 0 & 0 \\
s_1 & 0 & s_1 & s_2 & s_3 & s_4 \\
s_2 & 0 & s_2 & s_1 & s_4 & s_3 \\
s_3 & 0 & s_3 & -s_4 & s_1 & -s_2 \\
s_4 & 0 & s_4 & -s_3 & -s_2 & -s_1
\end{matrix}
$$
```
```md
# Разбиение полумагических квадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра25Полумагические, ~магические квадраты, ~полумагический квадрат, ~алгебра
### Text
Полумагические квадраты можно разбивать не только на 5 базисных квадратов, но и на два: чарующий и магический с нулевым E. При этом чарующий выполняет роль действительных чисел, а магический — мнимых.
$$(\alpha_0, a_1, a_2, a_3, a_4) = a_0s_0 + a_1s_1 + a_2s_2 + a_3s_3 + a_4s_4 = c(a_0, a_1, a_2) + m(0, a_3, a_4)$$
Правило умножения в новой системе:
$$a \cdot b = (a_0, a_1, a_2, a_3, a_4) \cdot (b_0, b_1, b_2, b_3, b_4) =$$
$$=(a_0b_0, a_1b_1 + a_2b_2 + a_3b_3 - a_4b_4, a_1b_2 + a_2b_1 - a_3b_4 + a_4b_3, a_1b_3 + a_2b_4 + a_3b_1 - a_4b_2, a_1b_4 + a_2b_3 - a_3b_2 + a_4b_1)$$
```
```md
# Параметры полумагического квадрата
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра26Параметры, ~магические квадраты, ~полумагический квадрат, ~алгебра
### Text
По данному полумагическому квадрату восстановить параметры несколько сложнее, чем по магическому. Если записать полумагический квадрат как матрицу через параметры, то мы получим следующее:
$$(a_0, a_1, a_2, a_3, a_4) =$$
$$= \frac{1}{3} \begin{pmatrix} a_0 + 2a_1 - a_2 + a_3\sqrt{3} & a_0 - a_1 - a_2 - a_3\sqrt{3} + a_4\sqrt{3} & a_0 - a_1 + 2a_2 - a_4\sqrt{3} \\ a_0 - a_1 - a_2 - a_3\sqrt{3} - a_4\sqrt{3} & a_0 - a_1 + 2a_2 + a_4\sqrt{3} & a_0 + 2a_1 - a_2 - a_3\sqrt{3} \\ a_0 - a_1 - a_2 + a_3\sqrt{3} - a_4\sqrt{3} & a_0 - a_1 - a_2 + a_3\sqrt{3} + a_4\sqrt{3} & a_0 + 2a_1 - a_2 - a_3\sqrt


```md
# Главное1ОпределениеМагическийКвадрат
### Info type
0_Contents
### Keywords
~Главное1ОпределениеМагическийКвадрат, ~магические квадраты, ~определение
### Text
**Магический квадрат** - это квадратная матрица чисел, в которой сумма чисел в каждой строке, столбце и диагонали одинакова. Эта сумма называется **магической константой**.

Например, квадрат 3x3:
'''
8 1 6
3 5 7
4 9 2
'''
```

```md
# Главное1ОпределениеМагическаяКонстанта
### Info type
0_Contents
### Keywords
~Главное1ОпределениеМагическаяКонстанта, ~магическая константа, ~определение, ~магические квадраты
### Text
**Магическая константа** магического квадрата - это сумма чисел в каждой строке, столбце и диагонали этого квадрата.
```

```md
# Главное1ОпределениеПолумагическийКвадрат
### Info type
0_Contents
### Keywords
~Главное1ОпределениеПолумагическийКвадрат, ~полумагический квадрат, ~определение, ~магические квадраты
### Text
**Полумагический квадрат** - это квадратная матрица чисел, в которой сумма чисел в каждой строке и столбце одинакова. В отличие от ~~Главное1ОпределениеМагическийКвадрат, не требуется, чтобы сумма чисел в диагоналях была равна магической константе.
```

```md
# Главное1ПроблемаКвадратныхКвадратов
### Info type
1_Main
### Keywords
~Главное1ПроблемаКвадратныхКвадратов, ~проблема квадратного квадрата, ~магические квадраты, ~квадратные числа
### Text
До сих пор остаётся нерешённым вопрос, существует ли магический квадрат 3x3, состоящий только из квадратных чисел. В данной работе такой квадрат будет называться **квадратным квадратом**.
```

```md
# Главное1ПримерПочтиКвадратногоКвадрата
### Info type
1_Main
### Keywords
~Главное1ПримерПочтиКвадратногоКвадрата, ~магические квадраты, ~квадратные числа, ~пример
### Text
Неизвестно, существует ли хотя бы один магический квадрат 3x3, содержащий хотя бы семь квадратных чисел, не считая одного известного:
'''
5652²    83521    3732²
232²     4252²   360721
222121²  5272²    2052²
'''
```

```md
# Главное1ОпределениеNДевятыхКвадратныйКвадрат
### Info type
1_Main
### Keywords
~Главное1ОпределениеNДевятыхКвадратныйКвадрат, ~N/9-квадратные квадраты, ~определение, ~квадратные числа, ~магические квадраты
### Text
**N/9-квадратный квадрат 3x3** - это магический квадрат 3x3, который содержит не менее N квадратных чисел.
```

```md
# Алгебра1Введение
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1Введение, ~алгебраические свойства, ~магические квадраты
### Text
Данная глава посвящена алгебраическим свойствам магических квадратов 3x3 и не имеет непосредственного отношения к проблеме ~~Главное1ПроблемаКвадратныхКвадратов.
```

```md
# Алгебра1ОсновныеСвойства
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1ОсновныеСвойства, ~основные свойства, ~магические квадраты, ~линейная система уравнений
### Text
Очевидно, что магический квадрат 3x3 можно представить в виде линейной системы уравнений с 9 неизвестными и 8 уравнениями.
Решение данной системы сводится к трём базисным решениям, в результате чего множество всех магических квадратов 3x3 может быть сопоставлено с множеством векторов длины 3.

Положим, что магический квадрат 3x3 имеет вид:
'''
A B C
D E F
G H I
'''

Обозначим магическую константу квадрата через M и сложим верхнюю и нижнюю строки:
$(A + B + C) + (G + H + I) = M + M = 2M$

С другой стороны, если мы перегруппируем слагаемые в левой части, то получим:
$(A + I) + (B + H) + (C + G) = (M - E) + (M - E) + (M - E) = 3M - 3E$

Откуда
$3M - 3E = 2M$
$M = 3E$
```

```md
# Алгебра1ВыводПараметризацииМагическогоКвадрата
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1ВыводПараметризацииМагическогоКвадрата, ~параметризация, ~магические квадраты
### Text
Определим $x = A - E$ и $y = G - E$.
Тогда магический квадрат можно представить в виде:
'''
E+x     E-x+y  E-y
E-x-y   E      E+x+y
E+y     E+x-y  E-x
'''

Пусть m(E, x, y) - магический квадрат 3x3, соответствующий тройке (E, x, y).
```

```md
# Алгебра1ЛинейноеПространствоМагическихКвадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1ЛинейноеПространствоМагическихКвадратов, ~линейное пространство, ~магические квадраты, ~векторное пространство
### Text
Множество всех магических квадратов 3x3 представляет собой линейное пространство над полем комплексных чисел.

Действительно, поскольку все элементы квадрата определены линейно относительно E, x, y, то для любых комплексных чисел E, x, y и c:
$m_1(E_1, x_1, y_1) + m_2(E_2, x_2, y_2) = m(E_1 + E_2, x_1 + x_2, y_1 + y_2)$
и
$c \cdot m(E, x, y) = m(c \cdot E, c \cdot x, c \cdot y)$
```

```md
# Алгебра1БазисЛинейногоПространстваМагическихКвадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1БазисЛинейногоПространстваМагическихКвадратов, ~базис, ~линейное пространство, ~магические квадраты
### Text
Определим базисы линейного пространства магических квадратов 3x3:
$m₀ = m(1, 0, 0) = $
'''
1 1 1
1 1 1
1 1 1
'''

$m₁ = m(0, 1, 0) = $
'''
1 -1 0
-1 0 1
0 1 -1
'''

$m₂ = m(0, 0, 1) = $
'''
0 1 -1
-1 0 1
1 -1 0
'''
```

```md
# Алгебра1ПреобразованияМагическихКвадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1ПреобразованияМагическихКвадратов, ~преобразования, ~магические квадраты, ~поворот, ~отражение, ~транспонирование
### Text
Для магических квадратов достаточно просто записываются их повороты, отражения и транспонирование:
'''
Исходный квадрат: m(E, x, y)
Поворот на 90°: m(E, -y, x)
Поворот на 180°: m(E, -x, -y)
Поворот на 270°: m(E, y, -x)

Отражение относительно горизонтальной оси: m(E, y, x)
Отражение относительно вертикальной оси: m(E, -y, -x)
Отражение относительно диагонали (транспонирование): m(E, -x, -y)
'''

Все магические квадраты, полученные из исходного квадрата путём данных преобразований, будем называть эквивалентными с точностью до поворота или симметрии (или просто эквивалентными).
```

```md
# Алгебра1ОпределениеЧарующийКвадрат
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1ОпределениеЧарующийКвадрат, ~чарующие квадраты, ~определение, ~матричное умножение
### Text
Применяя матричное умножение, заметим, что
'''
m₀ * m₀ = 3 * m₀

m₀ * m₁ = 0
m₀ * m₂ = 0
m₁ * m₀ = 0
m₂ * m₀ = 0
(0 - нулевая матрица)

m₁ * m₁ = m₃
m₁ * m₂ = -m₄
m₂ * m₁ = m₄
m₂ * m₂ = -m₃
'''
где
'''
m₃ =
[[2 -1 -1]
[-1  2 -1]
[-1 -1  2]]
'''
'''
m₄ =
[[-1 -1  2]
[ -1  2 -1]
[  2 -1 -1]]
'''

Мы определяем "чарующие квадраты" как множество комбинаций базисов m₀, m₃, m₄.
```

```md
# Алгебра1ТаблицаУмноженияБазисовM
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1ТаблицаУмноженияБазисовM, ~таблица умножения, ~линейное пространство, ~магические квадраты, ~чарующие квадраты
### Text
Матричное умножение над векторным пространством, порождённым базисами m₀, m₁, m₂, m₃, 3m₄ замкнуто и задано следующей таблицей умножения:

#### Таблица 1. Таблица умножения в линейном пространстве m₀-m₄
|         | m₀   | m₁   | m₂   | m₃   | m₄   |
|---------|------|------|------|------|------|
| **m₀**  | 3m₀  | 0    | 0    | 0    | 0    |
| **m₁**  | 0    | m₃   | -m₄  | 3m₁  | -3m₂ |
| **m₂**  | 0    | m₄   | -m₃  | 3m₂  | -3m₁ |
| **m₃**  | 0    | 3m₁  | 3m₂  | 3m₃  | 3m₄  |
| **m₄**  | 0    | 3m₂  | 3m₁  | 3m₄  | 3m₃  |
```

```md
# Алгебра1ДополнительноеПреобразованиеБазисов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1ДополнительноеПреобразованиеБазисов, ~базис, ~линейное пространство, ~магические квадраты, ~чарующие квадраты
### Text
Для более удобного представления, можно изменить систему базисов:
'''
s₀ = m₀ / 3
s₁ = m₃ / 3
s₂ = m₄ / 3
s₃ = m₁ * √(3) / 3
s₄ = m₂ * √(3) / 3
'''

Тогда таблица умножения примет вид:

##### Таблица 2. Таблица умножения в линейном пространстве s₀-s₄
|         | s₀  | s₁  | s₂  | s₃  | s₄  |
|---------|-----|-----|-----|-----|-----|
| **s₀**  | s₀  | 0   | 0   | 0   | 0   |
| **s₁**  | 0   | s₃  | -s₄ | s₁  | -s₂ |
| **s₂**  | 0   | s₄  | -s₃ | s₂  | -s₁ |
| **s₃**  | 0   | s₁  | s₂  | s₃  | s₄  |
| **s₄**  | 0   | -s₂ | s₁  | s₄  | -s₃ |

Однако, поскольку магические квадраты обычно предполагаются содержащими только целые числа, то ~~Алгебра1ТаблицаУмноженияБазисовM является более удобной для вычислений.
```

```md
# Алгебра1СвойстваУмноженияКвадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1СвойстваУмноженияКвадратов, ~умножение, ~магические квадраты, ~чарующие квадраты
### Text
Матричное умножение отображает:
- Пару магических квадратов в чарующий квадрат
- Пару чарующих квадратов в чарующий квадрат
- Пару (чарующий квадрат, магический квадрат) в магический квадрат
- Пару (магический квадрат, чарующий квадрат) в магический квадрат

Данный набор правил умножения замыкает множество магических квадратов относительно тернарного матричного умножения, подобно тому, как это определено для мнимых чисел.
```

```md
# Алгебра1ФормулыУмноженияКвадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1ФормулыУмноженияКвадратов, ~формулы, ~умножение, ~магические квадраты, ~чарующие квадраты
### Text
'''
m(E₁, x₁, y₁) * m(E₂, x₂, y₂) = c(3E₁E₂, x₁x₂ - y₁y₂, y₁x₂ - x₁y₂)
c(E₁, x₁, y₁) * c(E₂, x₂, y₂) = 3c(E₁E₂, x₁x₂ + y₁y₂, y₁x₂ + x₁y₂)
m(E₁, x₁, y₁) * c(E₂, x₂, y₂) = 3m(E₁E₂, x₁x₂ - y₁y₂, y₁x₂ - x₁y₂)
c(E₁, x₁, y₁) * m(E₂, x₂, y₂) = 3m(E₁E₂, x₁x₂ + y₁y₂, y₁x₂ + x₁y₂)
'''
```

```md
# Алгебра1ПолумагическиеКвадратыКакСумма
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1ПолумагическиеКвадратыКакСумма, ~полумагический квадрат, ~магические квадраты, ~чарующие квадраты
### Text
Любой ~~Главное1ОпределениеПолумагическийКвадрат может быть представлен как сумма ~~Алгебра1ОпределениеМагическийКвадрат и ~~Алгебра1ОпределениеЧарующийКвадрат.

Полумагический квадрат будем определять следующей записью:
$sm(E, x, y, v, w) = c(E, v, w) + m(0, x, y)$
```

```md
# Алгебра1УмножениеПолумагическихКвадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1УмножениеПолумагическихКвадратов, ~умножение, ~полумагический квадрат
### Text
В общем виде произведение двух полумагических квадратов выглядит следующим образом:
'''
sm(E₁, x₁, y₁, w₁, v₁) * sm(E₂, x₂, y₂, w₂, v₂) =
sm(
   3E₁E₂,
   3x₁w₂ + 3x₂w₁ - 3y₁v₂ + 3y₂v₁,
  -3x₁v₂ + 3x₂v₁ + 3y₁w₂ + 3y₂w₁,
    x₁x₂ -  y₁y₂ + 3w₁w₂ + 3v₁v₂,
   -x₁y₂ +  x₂y₁ + 3w₁v₂ + 3w₂v₁,
)
'''
```

```md
# Алгебра1НормаПолумагическогоКвадрата
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1НормаПолумагическогоКвадрата, ~норма, ~определитель, ~полумагический квадрат
### Text
В качестве нормы полумагичического квадрата можно рассматривать его определитель.
$det(sm(E, x, y, w, v)) = -9E \cdot (3v² - 3w² + x² - y²)$
```

```md
# Алгебра1ОбратныйЭлементПолумагическогоКвадрата
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1ОбратныйЭлементПолумагическогоКвадрата, ~обратный элемент, ~полумагический квадрат
### Text
Обратный элемент к полумагическому квадрату существует при ненулевом определителе и может быть записан как
'''
sm(E, x, y, v, w)⁻¹ = sm(
  (3v² - 3w² + x² - y²) / 9E,
  -x / 3,
  -y / 3,
   v / 3,
  -w / 3,
) / (3v² - 3w² + x² - y²)
'''

Таким образом, все сингулярные полумагические квадраты удовлетворяют уравнению
$-9E \cdot (3v² - 3w² + x² - y²) <=> $

'''
|      E = 0
| ИЛИ  3(v² - w²) = y² - x²
'''

Второе условие, в случае магических и чарующих квадратов, означает, что абсолютные значения при коэффициентах второго и третьего компонент (m₁ и m₂, m₃ и m₄ соответственно), равны тогда и только тогда, когда квадрат не имеет обратного.

При этом матричная единица сама относится к чарующим квадратам и записывается в них как $c(1/3, 1/3, 0)$.
```

```md
# Алгебра1СпектрПолумагическогоКвадрата
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1СпектрПолумагическогоКвадрата, ~спектр, ~полумагический квадрат
### Text
Спектр любого полумагического квадрата задаётся как множество из 1-3 элементов:
$\{
  3v + \sqrt{9w² + 3x² - 3y²},
  3v - \sqrt{9w² + 3x² - 3y²},
  3E
\}$

Соответственно, для чарующего квадрата $c(E, v, w)$ спектр:
$\{ 3E, 3v \pm 3w \}$

И для магического квадрата $m(E, x, y)$ спектр:
$\{ 3E, \pm\sqrt{3x² - 3y²} \}$

Однако важно учитывать, что элементы $\lambda e - m(E, x, y)$ не являются ни магическими, ни чарующими квадратами, так как представляют собой сумму разнородных компонент (e - чарующий квадрат, m(E, x, y) - магический квадрат), в то время как для чарующих все элементы, порождаемые спектром, являются чарующими квадратами.
```

```md
# Алгебра1ИдеалыПолумагическихКвадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1ИдеалыПолумагическихКвадратов, ~идеалы, ~полумагический квадрат
### Text
Идеалами для полумагических квадратов являются как минимум два множества квадратов:

1. Множество всех полумагических квадратов, кратных m₀;
2. Множество всех полумагических квадратов, для которых коэффициент при m₀ равен нулю.
```

```md
# Алгебра1ДоказательствоИдеала1
### Info type
7_Approvement
### Keywords
~Алгебра1ДоказательствоИдеала1, ~доказательство, ~идеалы, ~полумагический квадрат
### Approves
~Алгебра1ИдеалыПолумагическихКвадратов
### Text
Докажем, что множество всех полумагических квадратов, кратных m₀, образует идеал.
'''
sm(E₀, 0, 0, 0, 0) * sm(E, x, y, v, w) = sm(
  3E₀E,
  3*0*w + 3*x*0 - 3*0*v + 3*y*0,
  -3*0*v + 3*x*0 + 3*0*w + 3*y*0,
    0*x -   0*y + 3*0*w + 3*0*v,
    -0*y +   x*0 + 3*0*v + 3*w*0,
) = sm(3E₀E, 0, 0, 0, 0)
'''
```

```md
# Алгебра1ДоказательствоИдеала2
### Info type
7_Approvement
### Keywords
~Алгебра1ДоказательствоИдеала2, ~доказательство, ~идеалы, ~полумагический квадрат
### Approves
~Алгебра1ИдеалыПолумагическихКвадратов
### Text
Докажем, что множество всех полумагических квадратов, для которых коэффициент при m₀ равен нулю, образует идеал.
'''
sm(0, x₁, y₁, v₁, w₁) * sm(E, x, y, v, w) = sm(
  3 * 0 * E,
  ...,
  ...,
  ...,
  ...,
) = sm(0, ..., ..., ..., ...)
'''
```

```md
# Алгебра1ИдеалСингулярныхПолумагическихКвадратов
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра1ИдеалСингулярныхПолумагическихКвадратов, ~идеалы, ~сингулярные квадраты, ~полумагический квадрат
### Text
Максимальным идеалом, причём единственным, является множество всех сингулярных полумагических квадратов.
```

```md
# Алгебра1ДоказательствоИдеалаСингулярныхКвадратов
### Info type
7_Approvement
### Keywords
~Алгебра1ДоказательствоИдеалаСингулярныхКвадратов, ~доказательство, ~идеалы, ~сингулярные квадраты, ~полумагический квадрат
### Approves
~Алгебра1ИдеалСингулярныхПолумагическихКвадратов
### Text
'''
Если sm(E₀, x₀, y₀, v₀, w₀) - сингулярный полумагический квадрат, то
det(sm(E₀, x₀, y₀, v₀, w₀)) = 0

Тогда для любого полумагического квадрата sm(E, x, y, v, w)
det(sm(E₀, x₀, y₀, v₀, w₀) * sm(E, x, y, v, w)) = det(sm(E₀, x₀, y₀, v₀, w₀)) * det(sm(E, x, y, v, w)) = 0 * det(sm(E, x, y, v, w)) = 0 =>

sm(E₀, x₀, y₀, v₀, w₀) * sm(E, x, y, v, w) тоже сингулярный полумагический квадрат
'''

По свойствам идеалов, если все сингулярные элементы образуют идеал, то он является максимальным и единственным максимальным, что и требовалось доказать.
```

```md
# Подходы1Введение
### Info type
1_Main
### Keywords
~Подходы1Введение, ~подходы к решению, ~проблема квадратного квадрата
### Text
В данном разделе будут рассмотрены некоторые подходы к решению проблемы ~~Главное1ПроблемаКвадратныхКвадратов, те свойства, которыми должны обладать квадратные квадраты.
```

```md
# Подходы1МинимальныйЦелочисленныйМагическийКвадрат
### Info type
1_Main
### Keywords
~Подходы1МинимальныйЦелочисленныйМагическийКвадрат, ~минимальный магический квадрат, ~магические квадраты
### Text
Минимальным магическим квадратом назовём такой магический квадрат $m(E, x, y)$ из целых $E, x, y ≥ 0$, у которого $gcd(E, x, y) = 1$ и $x ≥ y$.

Тогда любой магический квадрат из рациональных чисел может быть получен из минимального магического квадрата путём поворота, отражения и умножения на некоторое рациональное число.

Таким образом, большинство свойств минимального магического квадрата будут справедливы для всех магических квадратов, в силу чего в данном и последующих разделах мы будем рассматривать именно минимальные магические квадраты.

Операцию приведения магического квадрата к минимальному виду будем называть минимизацией.

Особенно это важно в случае поиска квадратного квадрата, так как минимизация квадратного квадрата также является квадратным квадратом.
```

```md
# Подходы1МодульнаяАрифметика
### Info type
1_Main
### Keywords
~Подходы1МодульнаяАрифметика, ~модульная арифметика, ~магические квадраты, ~квадратные квадраты
### Text
По аналогии с целыми числами, можно рассматривать модульную арифметику для целочисленных магических квадратов (где магические квадраты сравнимы по модулю тогда, когда сравнимы по модулю соответствующие элементы).

В силу того, что каждый элемент магического квадрата $m(E, x, y)$ является линейной комбинацией параметров $E$, $x$, $y$, можно записать:
$m(E, x, y) \equiv m(E \mod n, x \mod n, y \mod n) \pmod n$
```

```md
# Подходы1Лемма1МодулярнаяАрифметика
### Info type
1_Main
### Keywords
~Подходы1Лемма1МодулярнаяАрифметика, ~лемма, ~модульная арифметика, ~квадратные квадраты
### Text
Лемма 1. Если $m(e², x, y)$ - минимальный квадратный квадрат, то $e$ нечётное, а $x$ и $y$ кратны четырём.
```

```md
# Подходы1ДоказательствоЛеммы1
### Info type
7_Approvement
### Keywords
~Подходы1ДоказательствоЛеммы1, ~доказательство, ~лемма, ~модульная арифметика, ~квадратные квадраты
### Approves
~Подходы1Лемма1МодулярнаяАрифметика
### Text
Рассмотрим квадратный квадрат по модулю 4.

1. Предположим, что в квадрате $m(e², x, y)$ число $e$ чётное. Это означает, что магическая константа и центральный элемент делятся на 4,
$m(e², x, y) \equiv m(0, x, y) \pmod 4$
Известно, что все полные квадраты имеют либо вид $4k +1$, либо вид $4k$.

Если $x$ не кратен 4, то одно или оба из $e² + x$ и $e² - x$ не могут быть полными квадратами, что противоречит определению квадратного квадрата. Значит, $x$ кратен 4.

Аналогично, рассматривая $e² + y$ и $e² - y$, получим, что $y$ также кратен 4.

Значит, мы можем вынести коэффициент 4 за пределы квадрата и получить меньший квадратный квадрат, что противоречит минимальности исходного квадрата.

Следовательно, $e$ нечётное.

2. Теперь воспользуемся тем, что $e$ нечётное. В таком случае
$e² \equiv 1 \pmod 4$
$3e² \equiv 3 \pmod 4$ - магическая константа

Теперь, если $x \equiv 1$, то $e² + x \equiv 2$, а если $x \equiv 3$, то $e² - x \equiv 2$. Если же $x \equiv 2$, то $e² + x \equiv 3$. Все эти случаи противоречат тому условию, что $e² - x$ и $e² + x$ должны быть полными квадратами. Следовательно, $x \equiv 0 \pmod 4$.

Тем же путём придём к $y \equiv 0 \pmod 4$, что и требовалось доказать.
```


```md
# Полумагический квадрат в старом базисе
### Info type
4_Unuseful_but_interesting
### Keywords
~Алгебра27Полумагические, ~магические квадраты, ~полумагический квадрат, ~алгебра
### Text
Воспользуемся этим и отметим, что $a_0$ — полумагическая константа. Её легко найти, просто сложив все элементы в одной строке/столбце. $a_3$ — это разность верхнего левого угла и правого нижнего, умноженная на $\frac{\sqrt{3}}{2}$. Аналогично, $a_4$ выражается из двух других углов. Искать оставшиеся два параметра придётся по двум уравнениям. Удобнее всего рассматривать центральный элемент и угловой. Однако в целых числах, определённо, удобнее работать со старыми базисами, чтобы избежать иррациональности и дробей. В старых базисах:
$$c(E, z, w) + m(0, x, y) = m(E, x, y) + c(0, z, w)$$
$$
\begin{matrix}
E+x+2z-w & E-x+y-z-w & E-y-z+2w \\
E-x-y-z-w & E+2z+2w & E+x+y-z-w \\
E+y-z+2w & E-x+2z-w & E-x+2z-w
\end{matrix}
$$
Здесь E - магическая константа, делённая на 3, x - разность соответствующих углов, делённая на 2, y - аналогично, — это сумма главной диагонали, делённая на три, без двух E, и таким же образом получается из побочной диагонали.
```
```md
# Целочисленные магические квадраты
### Info type
2_N_of_Nine
### Keywords
~Целые1Определение, ~магические квадраты, ~целочисленные магические квадраты
### Text
Целочисленным магическим квадратом называть будем магический квадрат, все элементы которого целые числа. Говоря о магических квадратах, составленных из целых чисел, мы будем использовать запись m(E, x, y) в том смысле, в котором она вводилась в параграфе 1.2 данного материала, за тем исключением, что E, x, y принимаются заведомо целыми числами.
```
```md
# Теорема о целочисленности
### Info type
2_N_of_Nine
### Keywords
~Целые2Теорема, ~магические квадраты, ~целочисленные магические квадраты, ~теорема
### Text
Теорема. Магический квадрат m(E, x, y) является целочисленным тогда и только тогда, когда числа E, x, y - целые.
### Approves
~~Целые2Доказательство
```
```md
# Доказательство теоремы о целочисленности
### Info type
7_Approvement
### Keywords
~Целые2Доказательство, ~магические квадраты, ~целочисленные магические квадраты, ~теорема, ~доказательство
### Approves
~~Целые2Теорема
### Text
Доказательство. Если E, x, y целые, то, очевидно, и числа E-x-y, E-x, E-x+y, E-y, E, E+y, E+x-y, E+x, E+x+y - целые, а значит, и магический квадрат составлен из только целых чисел. Если квадрат целочисленный, то целым является и число E, так как оно само по себе — элемент квадрата. x - целое, потому что E+x целое, и E целое. Аналогично, y тоже целое.
```
```md
# Биекция целочисленных квадратов
### Info type
2_N_of_Nine
### Keywords
~Целые3Биекция, ~магические квадраты, ~целочисленные магические квадраты, ~биекция
### Text
То есть существует биекция между целочисленными магическими квадратами и тройками целых чисел. Биекция же полумагических квадратов с пятимерными целочисленными векторами не описывается так просто. Например, полумагический квадрат $m(\frac{z}{2}, \frac{x}{2}, \frac{y}{2}) + c(\frac{z}{2}, \frac{w}{2}, \frac{w}{2})$ будет состоять из только целых чисел при целых значениях параметров, а квадрат $m(0,1,1) + c(E, z, w)$ — нет.
```
```md
# Минимальные коллинеарные квадраты
### Info type
2_N_of_Nine
### Keywords
~Целые4Минимальный, ~магические квадраты, ~целочисленные магические квадраты, ~коллинеарность
### Text
Вернёмся к понятию коллинеарных квадратов и отметим, что из целочисленных коллинеарных квадратов интерес, как правило, представляет лишь минимальный квадрат, то есть такой m(E, x, y), что НОД(E, x, y) = 1. Элементы минимального магического квадрата взаимно просты в совокупности.
```
```md
# Минимальные квадратные квадраты
### Info type
2_N_of_Nine
### Keywords
~Целые5Минимальный, ~магические квадраты, ~целочисленные магические квадраты, ~квадратный магический квадрат
### Text
Минимальный магический квадрат является важным критерием в поиске квадратного квадрата. Наибольший общий делитель всех элементов квадратного квадрата обязательно вторая степень натурального числа. А значит, магический квадрат, полученный делением данного на НОД, будет так же квадратным. При этом найти минимальный квадрат предположительно проще, чем произвольный. Как минимум потому, что не нужно рассматривать не взаимно простые в совокупности E, x, y.
```
```md
# Магический квадрат по модулю
### Info type
3_tfmn
### Keywords
~Модуль1Определение, ~магические квадраты, ~модуль, ~сравнение
### Text
Определим сравнение двух целочисленных магических квадратов по модулю натурального числа следующим образом:
$$m(E, x, y) \equiv m(F, z, w) \mod a \Leftrightarrow \begin{cases} E \equiv F \mod a \\ x \equiv z \mod a \\ y \equiv w \mod a \end{cases}$$
Поскольку все элементы магического квадрата — линейные комбинации E, x, y, утверждение "все элементы квадрата m(E, x, y) сравнимы с соответствующими элементами квадрата m(F, z, w)" эквивалентно выражению m(E, x, y) = m(F, z, w) mod a.
```
```md
# Лемма о чётности E, x, y
### Info type
3_tfmn
### Keywords
~Модуль2Лемма, ~магические квадраты, ~модуль, ~лемма, ~чётность
### Text
Лемма 1. Если $m(E^2, x, y)$ — минимальный квадратный квадрат, то E нечётное, x, y — кратные четырём.
### Approves
~~Модуль2Доказательство
```
```md
# Доказательство леммы о чётности E, x, y
### Info type
7_Approvement
### Keywords
~Модуль2Доказательство, ~магические квадраты, ~модуль, ~лемма, ~чётность, ~доказательство
### Approves
~~Модуль2Лемма
### Text
Доказательство. Рассмотрим квадратный квадрат по модулю 4. Предположим, что в квадрате $m(E^2, x, y)$ E - чётное. Это означает, что магическая константа $3E^2$ и центральный элемент $E^2$ делятся на 4, $m(E^2, x, y) \equiv m(0, x, y) \mod 4$. Известно, что все полные квадраты имеют либо вид 4k+1, либо вид 4k. $E^2 + x$ и $E^2 - x$ одновременно полные квадраты. Если x не кратно 4, то одно или оба из них не могут быть квадратами — противоречие. Значит, x кратно 4. Аналогично, рассматривая $E^2 + y$ и $E^2 - y$ получим, что y также кратно 4. Значит, мы можем вынести коэффициент 4 за пределы квадрата и получить меньший квадратный квадрат. Теперь рассмотрим случай, когда Е - нечётное. В таком случае $E^2 \equiv 1 \mod 4$, $3E^2 \equiv 3 \mod 4$. Теперь, если $x \equiv 1 \mod 4$, то $E^2 + x \equiv 2 \mod 4$, а если $x \equiv 3 \mod 4$, $E^2 - x \equiv 2 \mod 4$. Если же $x \equiv 2 \mod 4$, $E^2 + x \equiv 3 \mod 4$. Все эти случаи противоречат тому условию, что $E^2 - x, E^2 + x$ — полные квадраты. Противоречие не возникает лишь в том случае, когда $x \equiv 0 \mod 4$. Тем же путём придём к $y \equiv 0 \mod 4$, чтд.
```
```md
# Лемма о делимости на 3
### Info type
3_tfmn
### Keywords
~Модуль3Лемма, ~магические квадраты, ~модуль, ~лемма, ~делимость
### Text
Лемма 2. Если $m(E^2, x, y)$ — минимальный квадратный квадрат, то E не делится на 3, а x, y делятся.
### Approves
~~Модуль3Доказательство
```
```md
# Доказательство леммы о делимости на 3
### Info type
7_Approvement
### Keywords
~Модуль3Доказательство, ~магические квадраты, ~модуль, ~лемма, ~делимость, ~доказательство
### Approves
~~Модуль3Лемма
### Text
Доказательство. $\forall a \in \mathbb{Z}, a \not\equiv 0 \mod 3: a^2 \equiv 1 \mod 3$. При этом, очевидно, магическая константа $3E^2 \equiv 0 \mod 3$. Из этого следует, что либо все три элемента в любой строке и столбце кратны 3, либо все не кратны 3. Поскольку столбцы пересекают строки, во всём квадрате все элементы либо кратны, либо все не кратны 3. Если все элементы кратны 3, то делением на 9 из данного квадратного квадрата получим меньший. Все элементы минимального, в таком случае, должны быть не кратны 3, откуда следует данная лемма.
```
```md
# Лемма о факторизации
### Info type
3_tfmn
### Keywords
~Гаусс1Лемма, ~магические квадраты, ~гауссовы числа, ~лемма, ~факторизация
### Text
Лемма 1. Если число m имеет факторизацию
$$m = 2^k p_1^{\alpha_1} p_2^{\alpha_2} ... p_n^{\alpha_n} q_1^{\beta_1} q_2^{\beta_2} ... q_m^{\beta_m},$$
где
$$\forall i \in [1, n]: p_i \text{ — простой множитель вида } 4k+1, \alpha_i \ge 1$$
$$\forall j \in [1, m]: q_j \text{ — простой множитель вида } 4k+3, \beta_j \ge 1$$
$$k \ge 1$$
тогда m
*   не может быть суммой двух квадратов, если хотя бы одно из чисел $\beta_j$ нечётное
*   представляется в виде суммы двух квадратов ровно $\frac{1}{2} (\alpha_1 + 1)(\alpha_2 + 1)...(\alpha_n + 1)$ способом, если хотя бы одно из чисел $\alpha_i$ чётные
*   представляется в виде суммы квадратов ровно $\frac{1}{2} ((\alpha_1 + 1)(\alpha_2 + 1)...(\alpha_n + 1) + 1)$ способом, если все числа $\alpha_i$ чётные
```
```md
# Лемма о делимости на простой множитель
### Info type
3_tfmn
### Keywords
~Гаусс2Лемма, ~магические квадраты, ~гауссовы числа, ~лемма, ~делимость
### Text
Лемма 2. Если m имеет простой множитель q вида 4k+3, и представляется в виде суммы квадратов $m = x^2 + y^2$, то неизбежно x и y делятся на q.
```
```md
# Разложения 2E^2 в сумму квадратов
### Info type
3_tfmn
### Keywords
~Гаусс3Разложение, ~магические квадраты, ~гауссовы числа, ~разложение
### Text
2E² представимо в виде суммы квадратов как минимум пятью различными способами:
$$2E^2 = A^2 + J^2$$
$$2E^2 = B^2 + H^2$$
$$2E^2 = C^2 + G^2$$
$$2E^2 = D^2 + F^2$$
$$2E^2 = E^2 + E^2$$
Отсюда либо $E^2 = p_1^\alpha \sigma^2$, либо $E^2 = \sigma^2$, где $\sigma$ - любое целое число, $p_1$ — простой делитель вида 4k+1. Однако отметим, что если $2E^2$ имеет лишь один простой делитель вида p, то при разложении $2E^2$ в суммы квадратов, слагаемые лишь в одном из разложений не будут делиться на p [так же имеет доказательство в гауссовых числах].
```
```md
# Ограничения на делители
### Info type
3_tfmn
### Keywords
~Гаусс4Ограничение, ~магические квадраты, ~гауссовы числа, ~ограничение
### Text
В таком случае, либо все элементы квадрата делятся на один и тот же множитель p, на квадрат которого можно будет разделить все элементы, либо не делятся всего два элемента, лежащие на одной вертикали/горизонтали/диагонали, проходящей через центр. Последнее невозможно, так как требует выполнения одной из четырёх не имеющих решений систем сравнений:
$$
\begin{cases}
x \equiv 0 \mod p \\
y \equiv 0 \mod p
\end{cases}
$$
$$
\begin{cases}
x \equiv 0 \mod p \\
y \not\equiv 0 \mod p
\end{cases}
$$
$$
\begin{cases}
x \not\equiv 0 \mod p \\
y \equiv 0 \mod p
\end{cases}
$$
$$
\begin{cases}
x \not\equiv 0 \mod p \\
y \not\equiv 0 \mod p
\end{cases}
$$
$$
\begin{cases}
y - x \equiv 0 \mod p \\
y + x \not\equiv 0 \mod p
\end{cases}
$$
$$
\begin{cases}
y - x \not\equiv 0 \mod p \\
y + x \equiv 0 \mod p
\end{cases}
$$
$$
\begin{cases}
y - x \equiv 0 \mod p \\
y + x \equiv 0 \mod p
\end{cases}
$$
Значит, E имеет как минимум два простых делителя вида 4k+1.
```
```md
# Ограничения на делители 2 и 3
### Info type
3_tfmn
### Keywords
~Гаусс5Ограничение, ~магические квадраты, ~гауссовы числа, ~ограничение
### Text
Из леммы 2 этого параграфа следует так же и то, что в минимальном квадратном квадрате E не имеет простых делителей вида 4k+3, отличных от трёх, иначе их можно было бы вынести. Согласно леммам прошлого параграфа, E не делится на 2 и на 3.
```
```md
# Теорема о факторизации центрального элемента
### Info type
3_tfmn
### Keywords
~Гаусс6Теорема, ~магические квадраты, ~гауссовы числа, ~теорема, ~факторизация
### Text
Объединим все эти факты в следующую теорему:
Теорема 1 (о факторизации центрального элемента минимального квадратного квадрата). Центральный элемент минимального квадратного квадрата имеет как минимум два простых делителя вида 4k+1 и не имеет простых делителей никакого другого вида.
```
```md
# Вычеты по модулю q
### Info type
3_tfmn
### Keywords
~Вычеты1Модуль, ~магические квадраты, ~вычеты, ~модуль
### Text
Положим, что элемент $A^2$ квадратного квадрата имеет простой множитель q вида 4k+3. Из того, что $2A^2 = F^2 + H^2$, сделаем вывод, что F и H также делятся на q.
$$A^2 = E^2 + x \equiv 0 \mod q$$
$$F^2 = E^2 + x + y \equiv 0 \mod q$$
$$y \equiv 0 \mod q$$
Рассмотрим этот квадрат по модулю q:
$$
\begin{pmatrix}
A^2 & B^2 & C^2 \\
D^2 & E^2 & F^2 \\
G^2 & H^2 & J^2
\end{pmatrix}
\equiv
\begin{pmatrix}
0 & E^2 + x & E^2 - y \\
E^2 - x - y & E^2 & 0 \\
E^2 + y & E^2 + x - y & E^2 - x
\end{pmatrix} \equiv
\begin{pmatrix}
0 & E^2 & E^2 \\
E^2 & E^2 & 0 \\
E^2 & 0 & E^2
\end{pmatrix} \mod q
$$
$$E^2 - x + E^2 \equiv 3E^2 \mod q \Rightarrow x \equiv -E^2 \mod q$$
$$
\begin{pmatrix}
A^2 & B^2 & C^2 \\
D^2 & E^2 & F^2 \\
G^2 & H^2 & J^2
\end{pmatrix}
\equiv
\begin{pmatrix}
0 & 2E^2 & E^2 \\
2E^2 & E^2 & 0 \\
E^2 & 0 & 2E^2
\end{pmatrix} \mod q
$$
При этом $2E^2$ — квадратичный вычет по модулю q, так как $B^2 \equiv 2E^2 \mod q$. $E^2$, очевидно, также является квадратичным вычетом по этому модулю.
```
```md
# Теорема о вычетах
### Info type
3_tfmn
### Keywords
~Вычеты2Теорема, ~магические квадраты, ~вычеты, ~теорема
### Text
В силу мультипликативного свойства квадратичных вычетов, $2E^2$ может быть квадратичным вычетом по тому и лишь по тому модулю, по которому квадратичным вычетом является число 2. Это, в свою очередь, означает, что q может быть любым простым вида 8k+7, но никогда не будет простым вида 8k+3 [Источник].
```
```md
# Определение неполного квадрата
### Info type
2_N_of_Nine
### Keywords
~Неполные1Определение, ~неполные квадраты, ~квадратный магический квадрат
### Text
Неполным квадратным квадратом назовём целочисленный квадрат, часть элементов которого — полные квадраты. Неполным n-квадратным квадратом, или просто n-квадратным квадратом, или квадратом-n/9 будем называть неполный квадратный квадрат, у которого как минимум n элементов являются полными квадратами. При произношении рекомендуется заменять число греческой приставкой, например, диквадратный или октаквадратный.
```
```md
# Гексаквадратный квадрат
### Info type
2_N_of_Nine
### Keywords
~Неполные2Пример, ~неполные квадраты, ~квадратный магический квадрат, ~гексаквадратный квадрат
### Text
Ниже представлен гексаквадратный квадрат:
$$
\begin{matrix}
1561 & 31^2 & 1^2 \\
-719 & 29^2 & 49^2 \\
41^2 & 721 & 11^2
\end{matrix}
$$
```
```md
# Проблема неполных квадратов
### Info type
2_N_of_Nine
### Keywords
~Неполные3Проблема, ~неполные квадраты, ~квадратный магический квадрат
### Text
Вопрос существования полного квадратного квадрата можно обобщить. До сих пор известен только один квадрат 7/9. Существуют ли другие квадраты 7/9 — открытая проблема математики.
```
```md
# Группы неполных квадратов
### Info type
2_N_of_Nine
### Keywords
~Неполные4Группы, ~неполные квадраты, ~квадратный магический квадрат, ~изоморфизм
### Text
Неполные квадраты могут быть разбиты на подгруппы по изоморфизмам. Так, например, все моноквадратные квадраты образуют три группы:
*   с квадратом в центре
*   с квадратом в углу
*   с квадратом на стороне
Действительно, неважно в каком углу стоит квадратное число. Поворотом магического квадрата мы можем поставить его на необходимое место.
```
```md
# Обозначения групп неполных квадратов
### Info type
2_N_of_Nine
### Keywords
~Неполные5Обозначение, ~неполные квадраты, ~квадратный магический квадрат, ~обозначение
### Text
Для моделирования групп мы используем обозначение "крестики-нолики", где X — квадратное число, а O — любое. Каждой группе также можно дать однозначное название вроде "центр, два соседних угла, сторона между ними и сторона напротив", более ёмкое — перечислением всех квадратов в АВС-модели, например, АВСЕН, а также ассоциативное, например, "Т-квадрат".
```
```md
# Системы уравнений неполных квадратов
### Info type
2_N_of_Nine
### Keywords
~Неполные6Системы, ~неполные квадраты, ~квадратный магический квадрат, ~уравнения
### Text
Кроме прочего, каждому квадрату соответствует своя система уравнений в целых числах, которую следует решить, чтобы научиться генерировать квадраты каждой отдельной группы. Имеет смысл перечислить все эти группы.
```
```md
# Группы 1/9
### Info type
2_N_of_Nine
### Keywords
~Неполные7Группы, ~неполные квадраты, ~квадратный магический квадрат, ~1/9
### Text
Существует 3 группы 1/9:
$$
\begin{matrix}
O & O & O \\
O & X & O \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
O & O & O \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
O & O & O \\
O & O & O
\end{matrix}
$$
центр
угол
сторона
$E = e^2$
$E + x = a^2$
$E - x + y = b^2$
```
```md
# Группы 2/9
### Info type
2_N_of_Nine
### Keywords
~Неполные8Группы, ~неполные квадраты, ~квадратный магический квадрат, ~2/9
### Text
8 групп 2/9:
$$
\begin{matrix}
O & X & O \\
O & X & O \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
O & O & O \\
O & X & O
\end{matrix}
$$
$$
\begin{matrix}
X & O & X \\
O & O & O \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
O & O & X \\
O & X & O \\
O & O & O
\end{matrix}
$$
центр и угол
центр и сторона
соседние углы
противоположные углы
$$
\begin{cases}
E = e^2 \\
E + x = a^2
\end{cases}
$$
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - y = c^2
\end{cases}
$$
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - x + y = b^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - x = j^2
\end{cases}
$$
```
```md
# Группы 3/9
### Info type
2_N_of_Nine
### Keywords
~Неполные9Группы, ~неполные квадраты, ~квадратный магический квадрат, ~3/9
### Text
16 групп 3/9:
$$
\begin{matrix}
O & X & O \\
X & O & O \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
O & O & X \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
X & X & O \\
O & O & O \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
O & O & O \\
X & O & O
\end{matrix}
$$
соседние стороны
противоположные углы
угол и прилежащая сторона
угол и противолежащая сторона
$$
\begin{cases}
E - x + y = b^2 \\
E - x - y = d^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - x + y = b^2
\end{cases}
$$
$$
\begin{cases}
E+x = a^2 \\
E-y = c^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E + x + y = f^2
\end{cases}
$$
$$
\begin{matrix}
X & O & X \\
O & X & O \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
X & O & O \\
O & X & X \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
O & O & X \\
X & O & X \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
X & O & X \\
O & O & O \\
O & X & O
\end{matrix}
$$
центр и
соседние углы
центр и
противоположные углы
центр и
соседние стороны
центр и
противоположные стороны
$$
\begin{cases}
E = e^2 \\
E - y = c^2
\end{cases}
$$
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - x - y = d^2
\end{cases}
$$
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - x + y = b^2
\end{cases}
$$
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - x = j^2
\end{cases}
$$
$$
\begin{matrix}
X & O & O \\
O & X & O \\
O & O & X
\end{matrix}
$$
$$
\begin{matrix}
O & X & X \\
X & O & O \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
X & O & X \\
O & O & X \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
X & O & X \\
O & O & O
\end{matrix}
$$
центр, угол и
прилежащая сторона
центр, угол и
противолежащая сторона
три угла
три стороны
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - x + y = b^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - y = c^2 \\
E - x - y = d^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - y = c^2 \\
E + y = g^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - x + y = b^2 \\
E + x + y = f^2
\end{cases}
$$
$$
\begin{matrix}
X & X & O \\
O & X & O \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
X & O & O \\
O & O & X
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
O & X & O \\
X & O & O
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
O & O & X \\
O & X & O
\end{matrix}
$$
соседние углы и
сторона между
соседние углы и
сторона напротив
соседние углы и
сторона при одном из них
противоположные углы и сторона
$$
\begin{cases}
E + x = a^2 \\
E - y = c^2 \\
E - x + y = b^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - x + y = b^2 \\
E - x - y = d^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - y = c^2 \\
E - x - y = d^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - x = j^2 \\
E - x + y = b^2
\end{cases}
$$
```
```md
# Группы 4/9
### Info type
2_N_of_Nine
### Keywords
~Неполные10Группы, ~неполные квадраты, ~квадратный магический квадрат, ~4/9
### Text
22 группы 4/9:
$$
\begin{matrix}
X & O & X \\
O & X & O \\
O & O & X
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
X & X & O \\
O & O & X
\end{matrix}
$$
$$
\begin{matrix}
X & X & X \\
O & X & O \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
X & O & X \\
O & O & X \\
O & X & O
\end{matrix}
$$
центр и три угла
центр и три стороны
центр,
соседние углы и
сторона между
центр,
соседние углы и
сторона напротив
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - y = c^2 \\
E + y = g^2
\end{cases}
$$
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - x + y = b^2 \\
E - x - y = d^2
\end{cases}
$$
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - y = c^2 \\
E + x + y = f^2
\end{cases}
$$
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - y = c^2 \\
E + x - y = h^2
\end{cases}
$$
$$
c^2 + g^2 = 2e^2
$$
$$
d^2 + f^2 = 2e^2
$$
$$
a^2 + b^2 + c^2 = 3e^2
$$
$$
a^2 + c
```

```md
# Группы 4/9 (продолжение)
### Info type
2_N_of_Nine
### Keywords
~Неполные11Группы, ~неполные квадраты, ~квадратный магический квадрат, ~4/9
### Text
$$
\begin{matrix}
X & X & O \\
O & X & X \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
O & X & X \\
X & O & X \\
O & O & O
\end{matrix}
$$
$$
\begin{matrix}
X & X & O \\
O & O & X \\
O & X & O
\end{matrix}
$$
$$
\begin{matrix}
X & O & X \\
X & O & O \\
O & O & X
\end{matrix}
$$
центр, соседние углы и сторона при одном из них
центр,
противоположные углы и сторона
центр, соседние стороны и угол между ними
центр, соседние стороны и угол напротив
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - y = c^2 \\
E - x - y = d^2
\end{cases}
$$
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - x = j^2 \\
E + x - y = b^2
\end{cases}
$$
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - x + y = b^2 \\
E - x - y = d^2
\end{cases}
$$
$$
\begin{cases}
E = e^2 \\
E - x + y = b^2 \\
E - x - y = d^2 \\
E - x = j^2
\end{cases}
$$
$$
a^2 + d^2 = c^2 + e^2
$$
$$
a^2 + j^2 = 2e^2
$$
$$
2a^2 + b^2 + d^2 = 4e^2
$$
$$
b^2 + d^2 = 2j^2
$$
$$
\begin{matrix}
O & X & O \\
X & X & O \\
O & O & X
\end{matrix}
$$
$$
\begin{matrix}
X & O & X \\
O & X & O \\
O & X & O
\end{matrix}
$$
$$
\begin{matrix}
X & X & O \\
O & X & O \\
O & O & X
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
O & X & X \\
X & O & O
\end{matrix}
$$
центр, соседние стороны и угол при одной из них
центр,
четыре стороны
центр,
четыре угла
центр,
четыре угла
$$
\begin{cases}
E = e^2 \\
E - x + y = b^2 \\
E - x - y = d^2 \\
E - y = c^2
\end{cases}
$$
$$
\begin{cases}
E = e^2 \\
E + x = a^2 \\
E - y = c^2 \\
E + x - y = h^2
\end{cases}
$$
$$
\begin{cases}
E - x = j^2 \\
E - x + y = b^2 \\
E - x - y = d^2
\end{cases}
$$
$$
\begin{cases}
E - x = j^2 \\
E + x - y = b^2 \\
E + y = g^2
\end{cases}
$$
$$
2e^2 = b^2 + d^2
$$
$$
c^2 + h^2 = 2e^2
$$
$$
b^2 + h^2 = d^2 + f^2
$$
$$
a^2 + j^2 = c^2 + g^2
$$
```
```md
# Группы 5/9
### Info type
2_N_of_Nine
### Keywords
~Неполные12Группы, ~неполные квадраты, ~квадратный магический квадрат, ~5/9
### Text
$$
\begin{matrix}
O & X & O \\
X & O & X \\
X & O & O
\end{matrix}
$$
$$
\begin{matrix}
X & O & X \\
O & X & O \\
X & O & O
\end{matrix}
$$
$$
\begin{matrix}
X & O & X \\
O & X & O \\
O & O & X
\end{matrix}
$$
$$
\begin{matrix}
X & X & O \\
X & O & X \\
O & O & O
\end{matrix}
$$
три стороны и внешний угол
три угла и внутренняя сторона
три угла и внешняя сторона
три стороны и внутренний угол
$$
\begin{cases}
E + y = g^2 \\
E - x + y = b^2 \\
E - x - y = d^2 \\
E + x + y = f^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - y = c^2 \\
E + y = g^2 \\
E - x + y = b^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - y = c^2 \\
E + y = g^2 \\
E - x - y = d^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - x + y = b^2 \\
E + x + y = f^2 \\
E - x - y = d^2
\end{cases}
$$
$$
b^2 + f^2 = 2g^2
$$
$$
2a^2 + 2b^2 = c^2 + 3g^2
$$
$$
2f^2 - 2a^2 = g^2 - c^2
$$
$$
2f^2 - 2a^2 = b^2 - d^2
$$
$$
\begin{matrix}
X & O & X \\
X & O & O \\
O & X & O
\end{matrix}
$$
$$
\begin{matrix}
X & O & X \\
O & O & X \\
O & X & O
\end{matrix}
$$
$$
\begin{matrix}
X & X & O \\
O & X & O \\
O & X & O
\end{matrix}
$$
$$
\begin{matrix}
X & O & X \\
O & X & O \\
X & O & O
\end{matrix}
$$
соседние углы и не общие стороны при них
соседние углы, общая сторона и сторона напротив
соседние углы и две стороны при одном из них
противоположные углы и стороны
$$
\begin{cases}
E + x = a^2 \\
E - y = c^2 \\
E - x - y = d^2 \\
E + x + y = f^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - y = c^2 \\
E - x + y = b^2 \\
E + x - y = h^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - y = c^2 \\
E - x + y = b^2 \\
E - x - y = d^2
\end{cases}
$$
$$
\begin{cases}
E + x = a^2 \\
E - x = j^2 \\
E - x + y = b^2 \\
E + x - y = h^2
\end{cases}
$$
$$
2a^2 - 2c^2 = d^2 - f^2
$$
$$
2a^2 + 2c^2 = b^2 + 3h^2
$$
$$
2a^2 + 3d^2 = b^2 + 4c^2
$$
$$
a^2 + b^2 = f^2 + j^2
$$
```
```md
# О группах 6/9 и более
### Info type
2_N_of_Nine
### Keywords
~Неполные13Группы, ~неполные квадраты, ~квадратный магический квадрат
### Text
Что же касается квадратов 5/9, 6/9, 7/9 и 8/9, то количества их групп совпадают с количествами групп квадратов 4/9, 3/9, 2/9 и 1/9 соответственно. Их визуальные модели получаются инверсией уже перечисленных моделей, а множества решений — пересечением множеств решений нескольких из них.
```
```md
# Тривиальные системы
### Info type
2_N_of_Nine
### Keywords
~Неполные14Тривиальные, ~неполные квадраты, ~квадратный магический квадрат, ~тривиальные
### Text
Очевидно, что системы, которыми задаются квадраты 1/9 и 2/9, а также большинство 3/9 — тривиальны. Квадратные числа, находящиеся в правой части уравнений — всего лишь параметры, а переменные E, x, y однозначно задаются через них.
```
```md
# Нетривиальные системы
### Info type
2_N_of_Nine
### Keywords
~Неполные15Нетривиальные, ~неполные квадраты, ~квадратный магический квадрат, ~нетривиальные
### Text
Однако когда количество линейных уравнений в системе начинает превышать количество переменных, от которых она линейно зависит, параметры из правой части начинают выполнять роли переменных, и мы вынуждены решать сложные уравнения в целых числах.
```
```md
# Пример решения системы
### Info type
2_N_of_Nine
### Keywords
~Неполные16Пример, ~неполные квадраты, ~квадратный магический квадрат, ~пример
### Text
Например, квадрат "противоположные углы и соседние стороны при них", можно решить следующим образом:
$$
\begin{cases}
E + x = a^2 \\
E - x = j^2 \\
E - x + y = b^2 \\
E + x + y = f^2
\end{cases}
$$
$$x = \frac{a^2 - j^2}{2}$$
$$E = \frac{a^2 + j^2}{2}$$
$$y = b^2 - j^2$$
$$a^2 + b^2 = f^2 + j^2$$
После чего остаётся решить уравнение $a^2 + b^2 = f^2 + j^2$. На данном этапе вспомним параграф 2.3 и отметим, что чтобы иметь как минимум два различных представления в виде суммы квадратов, число $a^2 + b^2$ должно делиться на как минимум две суммы квадратов. Можем записать следующее:
$$a^2 + b^2 = (m^2 + n^2)(k^2 + l^2) = m^2k^2 + n^2l^2 + m^2l^2 + n^2k^2 =$$
$$= m^2k^2 + 2mnkl + n^2l^2 + m^2l^2 - 2mnkl + n^2k^2 =$$
$$= (mk + nl)^2 + (ml - nk)^2 = (mk - nl)^2 + (ml + nk)^2 = f^2 + j^2$$
И теперь заметим, что
$$E = \frac{(mk + nl)^2 + (mk - nl)^2}{2} = m^2k^2 + n^2l^2$$
$$x = \frac{(mk + nl)^2 - (mk - nl)^2}{2} = 2klmn$$
$$y = (ml - nk)^2 - (mk - nl)^2 = m^2l^2 + n^2k^2 - m^2k^2 - n^2l^2 = (m^2 - n^2)(l^2 - k^2)$$
является решением системы. Единственным ли? — более сложный вопрос. В данном случае мы, скорее всего, можем доказать единственность данного решения, однако большинство описанных выше групп решаются более сложно, и даже не всегда имеют решение, записанное параметрически. Автор данного материала приводит данный пример, чтобы показать логику решения одной отдельной модели.
```
```md
# Примеры решения системы
### Info type
2_N_of_Nine
### Keywords
~Неполные17Примеры, ~неполные квадраты, ~квадратный магический квадрат, ~пример
### Text
Итак, давайте посмотрим некоторые примеры квадратов, генерируемых данным решением.
*   m = 4, n = 1, k = 2, l = 3:
    *   E = 16 * 4 + 1 * 9 = 73
    *   x = 2 * 2 * 3 * 4 * 1 = 48
    *   y = (16 - 1)(9 - 4) = 15 * 5 = 75
    $$m(73, 48, 75) = \begin{pmatrix} 121 & 100 & -2 \\ -50 & 73 & 196 \\ 148 & 46 & 25 \end{pmatrix}$$
*   m = 7, n = 11, k = 13, l = 4:
    *   E = 49 * 169 + 121 * 16 = 10217
    *   x = 2 * 4 * 7 * 11 * 13 = 8008
    *   y = (49 - 121)(16 - 169) = 11016
    $$m(10217, 8008, 11016) = \begin{pmatrix} 18225 & 13225 & -799 \\ -8807 & 10217 & 29241 \\ 21233 & 7209 & 2209 \end{pmatrix}$$
Заметим, что в данных примерах квадраты не удовлетворяют условиям, описанным во второй главе.
```
```md
# Генерация квадратов
### Info type
2_N_of_Nine
### Keywords
~Неполные18Генерация, ~неполные квадраты, ~квадратный магический квадрат, ~генерация
### Text
Генерация всех магических квадратов, удовлетворяющих только конкретной группе уменьшает количество рассматриваемых квадратов, и соответственно увеличивает вероятность обнаружения полного квадратного квадрата. Применение же условий к генерации ещё сильнее ограничивает множество перебираемых магических квадратов.
```
```md
# Предположение о невозможности
### Info type
2_N_of_Nine
### Keywords
~Неполные19Предположение, ~неполные квадраты, ~квадратный магический квадрат, ~невозможность
### Text
Если же предположить, что полный магический квадрат всё же не возможен, то решение различных подгрупп и наложение дополнительных условий может в конце концов привести к противоречию и тем самым доказать эту невозможность.
```
```md
# Определение тривиального квадрата
### Info type
3_tfmn
### Keywords
~Dir1Определение, ~неполные квадраты, ~квадратный магический квадрат, ~тривиальный
### Text
Об этом упомяналось в предыдущем параграфе, повторим это и здесь более осмысленно: тривиальным неполным квадратным квадратом будем считать неполный квадрат, решение которого требует решения лишь линейных уравнений. Нетривиальным квадратом же считается любой другой.
```
```md
# Примеры тривиального и нетривиального квадратов
### Info type
3_tfmn
### Keywords
~Dir2Примеры, ~неполные квадраты, ~квадратный магический квадрат, ~тривиальный, ~нетривиальный
### Text
Ниже приведены примеры тривиального и нетривиального квадратов 3/9:
$$
\begin{matrix}
X & X & X \\
O & O & O \\
O & O & O
\end{matrix}
\Leftrightarrow
\begin{cases}
E + x = a^2 \\
E - x + y = b^2 \\
E - y = c^2
\end{cases}
\Leftrightarrow
\begin{cases}
E = (a^2 + b^2 + c^2) / 3 \\
x = (2a^2 - b^2 - c^2) / 3 \\
y = (a^2 + b^2 - 2c^2) / 3
\end{cases}
$$
a, b, c - просто параметры.
Тривиальный:
$$
\begin{matrix}
O & O & O \\
X & X & X \\
O & O & O
\end{matrix}
\Leftrightarrow
\begin{cases}
E = e^2 \\
E - x - y = d^2 \\
E + x + y = f^2
\end{cases}
\Leftrightarrow
\begin{cases}
E = e^2 \\
x + y = e^2 - d^2 \\
x + y = f^2 - e^2
\end{cases}
$$
Нетривиальный: Вынуждены решать $2e^2 = f^2 + d^2$. e, d, f - теперь переменные.
```
```md
# Особенности нетривиальных 3-квадратов
### Info type
3_tfmn
### Keywords
~Dir3Особенности, ~неполные квадраты, ~квадратный магический квадрат, ~нетривиальный
### Text
У нетривиальных 3-квадратов есть две особенности. Первая особенность — для каждого из них одна из переменных E, x, y может принимать любые значения. Это даёт дополнительные возможности для объединения нескольких групп 3/9 в одну группу 5/9 или 6/9. Вторая — все они требуют решения одной и той же задачи: найти все такие A, что $A^2 - x, A^2, A^2 + x$ — квадратные числа. Или, другими словами, задать в общем виде арифметическую прогрессию, три последовательных члена которой — квадратные числа. Или, максимально просто, решить уравнение $a^2 + c^2 = 2b^2$, где $a^2, b^2, c^2$ — те самые последовательные квадраты.
```
```md
# Определение интересной тройки
### Info type
3_tfmn
### Keywords
~Dir4Определение, ~неполные квадраты, ~квадратный магический квадрат, ~интересная тройка
### Text
Поскольку данное уравнение довольно похоже на подобное, задающее пифагоровы тройки, тройку чисел, подходящую под данное уравнение, в окружении автора материала принято называть интересной. Решение этого уравнения в общем виде:
$$a = (m^2 - n^2 - 2mn)k$$
$$b = (m^2 + n^2)k$$
$$c = (m^2 - n^2 + 2mn)k$$
```
```md
# Dir-функция
### Info type
3_tfmn
### Keywords
~Dir5Dir-функция, ~неполные квадраты, ~квадратный магический квадрат, ~функция
### Text
Однако автор материала предлагает это же решение записать в несколько другом, более компактном виде. Для этого введём функцию
$$dir(\alpha, \beta) = \frac{\alpha\beta (\alpha^2 - \beta^2)}{(\alpha^2 + \beta^2)^2}$$
И заметим, что $\frac{c^2 - b^2}{b^2} = 4dir(m, n)$. И далее, возвращаясь к определению тройки $a^2, b^2, c^2$ как чисел $A^2 - x, A^2, A^2 + x$, запишем решение системы одним-единственным выражением:
$$x = 4A^2dir(m, n)$$
при любых взаимно простых m, n, если одно из m, n — чётное.
```
```md
# Связь с арифметической прогрессией
### Info type
3_tfmn
### Keywords
~Dir6Связь, ~неполные квадраты, ~квадратный магический квадрат, ~арифметическая прогрессия
### Text
В таком случае взаимно просты выражения $mn(m^2 - n^2)$ и $(m^2 + n^2)^2$, а значит A должно неизбежно делиться на $(m^2 + n^2)^2$. В результате все необходимые ограничения отражены в данном выражении.
```
```md
# Свойства dir-функции
### Info type
3_tfmn
### Keywords
~Dir7Свойства, ~неполные квадраты, ~квадратный магический квадрат, ~dir-функция, ~свойства
### Text
Отсюда другое название интересной тройки — dir-тройка, или просто дир. История названия функции, увы, забыта, однако ввиду привычки автора и его окружения, оно сохранено. Отметим пару свойств dir-функции:
$$dir(k\alpha, k\beta) = dir(\alpha, \beta)$$
$$dir(\alpha + \beta, \alpha - \beta) = dir(\alpha, \beta)$$
```
```md
# fmn-функция и c(m,n)
### Info type
3_tfmn
### Keywords
~Dir8fmn, ~неполные квадраты, ~квадратный магический квадрат, ~функция
### Text
Далее для удобства обозначим числитель dir-функции как f(m, n), а знаменатель как c(m, n). И теперь мы имеем аппарат для ёмкого описания всех нетривиальных 3-квадратных квадратов:
$$
\begin{matrix}
\text{группа} & \text{решение} & m(E, x, y) \\
\begin{matrix} O & X & O \\ O & O & X \\ O & O & O \end{matrix} & x = 4E^2dir(m, n) & m(k^2c(m, n), 4k^2f(m, n), y) \\
\begin{matrix} O & X & O \\ O & X & O \\ O & O & O \end{matrix} & y - x = 4E^2dir(m, n) & m(k^2c(m, n), x, 4k^2f(m, n) + x) \\
\begin{matrix} X & O & O \\ O & O & X \\ O & X & O \end{matrix} & y = 4A^2dir(m, n) & m(E, k^2c(m, n) - E, 4k^2f(m, n))
\end{matrix}
$$
Здесь мы видим сказанное выше: для каждой группы одна из переменных остаётся свободной. Для первой группы это y, для второй x, для третьей E.
```
```md
# Интересные тройки
### Info type
3_tfmn
### Keywords
~Dir9Тройки, ~неполные квадраты, ~квадратный магический квадрат, ~интересные тройки
### Text
В общем же, в квадратном квадрате можно отыскать 8 интересных троек:
$$
\begin{matrix}
X & O & O \\
O & O & X \\
O & X & O
\end{matrix}
$$
$$
\begin{matrix}
O & O & X \\
O & X & O \\
O & X & O
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
O & X & O \\
O & O & X
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
O & O & X \\
X & O & O
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
X & O & O \\
O & O & X
\end{matrix}
$$
$$
\begin{matrix}
O & O & X \\
X & O & O \\
O & X & O
\end{matrix}
$$
$$
\begin{matrix}
O & X & O \\
O & O & X \\
O & X & O
\end{matrix}
$$
$$
\begin{matrix}
X & O & O \\
O & X & O \\
O & X & O
\end{matrix}
$$
Первые две группы объединим словом "диагональ", следующие две словом "ортогональ", а последние четыре "ход коня".
```
```md
# dir-квадраты
### Info type
3_tfmn
### Keywords
~Dir10dir-квадрат, ~неполные квадраты, ~квадратный магический квадрат, ~dir-квадрат
### Text
Объединение двух пар троек генерирует либо группу квадратов 5/9, либо 6/9. Неполные квадратные квадраты, составленные из одних только интересных троек, назовём dir-квадратами. Существует 6 групп 5-dir-квадратов. Решим каждую из них:
```
```md
# Два диагональных dir-квадрата
### Info type
3_tfmn
### Keywords
~Dir11Диагональ, ~неполные квадраты, ~квадратный магический квадрат, ~dir-квадрат
### Text
1. Две диагонали (ACEGJ-квадрат):
$$
\begin{cases}
x = 4E^2dir(m_1, n_1) \\
y = 4E^2dir(m_2, n_2)
\end{cases}
$$
$$E^2 = \text{НОК}(c(m_1, n_1), c(m_2, n_2))$$
2. Две ортогонали (BDEFH-квадрат):
$$
\begin{cases}
x + y = 4E^2dir(m_1, n_1) \\
y - x = 4E^2dir(m_2, n_2)
\end{cases}
$$
$$E^2 = \text{НОК}(c(m_1, n_1), c(m_2, n_2))$$
$$
\begin{cases}
x = 2E^2(dir(m_1, n_1) - dir(m_2, n_2)) \\
y = 2E^2(dir(m_1, n_1) + dir(m_2, n_2))
\end{cases}
$$
```
```md
# Диагональ и ортогональ
### Info type
3_tfmn
### Keywords
~Dir12ДиагональОртогональ, ~неполные квадраты, ~квадратный магический квадрат, ~dir-квадрат
### Text
3. Диагональ и ортогональ (ABEHJ-квадрат):
$$
\begin{cases}
x = 4E^2dir(m_1, n_1) \\
y - x = 4E^2dir(m_2, n_2)
\end{cases}
$$
$$E^2 = \text{НОК}(c(m_1, n_1), c(m_2, n_2))$$
$$
\begin{cases}
x = 4E^2dir(m_1, n_1) \\
y = 4E^2(dir(m_1, n_1) + dir(m_2, n_2))
\end{cases}
$$
```
```md
# Диагональ и ход конём
### Info type
3_tfmn
### Keywords
~Dir13ДиагональКонь, ~неполные квадраты, ~квадратный магический квадрат, ~dir-квадрат
### Text
4. Диагональ и ход конём из одного угла (AEFHJ-квадрат):
$$
\begin{cases}
x = 4E^2dir(m_1, n_1) \\
y = 4(E^2 + x)dir(m_2, n_2)
\end{cases}
$$
$$E^2 = c(m_1, n_1)k^2$$
$$
\begin{cases}
x = 4k^2f(m_1, n_1) \\
y = 4k^2(c(m_1, n_1) + 4f(m_1, n_1))dir(m_2, n_2)
\end{cases}
$$
Здесь параметр k вводится на случай, когда $c(m_1, n_1) + 4f(m_1, n_1)$ не делится на $c(m_2, n_2)$. На практике мы можем принимать k = 1 и домножать весь квадрат на необходимый множитель, если y окажется дробным.
```
```md
# Ортогональ и ход конём
### Info type
3_tfmn
### Keywords
~Dir14ОртогональКонь, ~неполные квадраты, ~квадратный магический квадрат, ~dir-квадрат
### Text
5. Ортогональ и ход конём (ABEFH-квадрат):
$$
\begin{cases}
y - x = 4E^2dir(m_1, n_1) \\
y = 4(E^2 + x)dir(m_2, n_2)
\end{cases}
$$
$$
\begin{cases}
y - A^2 + E^2 = 4E^2dir(m_1, n_1) \\
y = 4A^2dir(m_2, n_2)
\end{cases}
$$
$$
4A^2dir(m_2, n_2) - A^2 = 4E^2dir(m_1, n_1) - E^2
$$
$$
A^2(1 - 4dir(m_2, n_2)) = E^2(1 - 4dir(m_1, n_1))
$$
$$
A^2 = c(m_2, n_2) \cdot (c(m_1, n_1) - 4f(m_1, n_1))
$$
$$
E^2 = c(m_1, n_1) \cdot (c(m_2, n_2) - 4f(m_2, n_2))
$$
$$
y = 4f(m_2, n_2) \cdot (c(m_1, n_1) - 4f(m_1, n_1))
$$
$$
E^2 = c(m_1, n_1) \cdot (c(m_2, n_2) - 4f(m_2, n_2))
$$
$$
x = 4(c(m_1, n_1) \cdot f(m_2, n_2) - c(m_2, n_2) \cdot f(m_1, n_1))
$$
$$
y = 4f(m_2, n_2) \cdot (c(m_1, n_1) - 4f(m_1, n_1))
$$
Поясним следующий момент: в п.4 мы не вводим замену $E^2 + x = A^2$, так как мы точно знаем то, что $E^2 + x$ является квадратом: на это указывает первое уравнение системы. В п.5 мы вынуждены ввести замену $E^2 + x = A^2$, поскольку первое уравнение не даёт никакой информации на этот счёт.
```
```md
# Пересекающиеся ходы конём
### Info type
3_tfmn
### Keywords
~Dir15Конь, ~неполные квадраты, ~квадратный магический квадрат, ~dir-квадрат
### Text
6. Пересекающиеся ходы конём (ACDFH-квадрат):
$$
\begin{cases}
x = 4C^2dir(m_1, n_1) \\
y = 4A^2dir(m_2, n_2)
\end{cases}
$$
$$
\begin{cases}
A^2 - E = 4C^2dir(m_1, n_1) \\
E - C^2 = 4A^2dir(m_2, n_2)
\end{cases}
$$
$$
E = A^2 - 4C^2dir(m_1, n_1)
$$
$$
A^2 - 4C^2dir(m_1, n_1) - C^2 = 4A^2dir(m_2, n_2)
$$
$$
E = A^2 - 4C^2dir(m_1, n_1)
$$
$$
A^2(1 - 4dir(m_2, n_2)) = C^2(1 + 4dir(m_1, n_1))
$$
$$
E = A^2 - 4C^2dir(m_1, n_1)
$$
$$
A^2 = c(m_2, n_2)(c(m_1, n_1) + 4f(m_1, n_1))
$$
$$
C^2 = c(m_1, n_1)(c(m_2, n_2) - 4f(m_2, n_2))
$$
$$
E = c(m_1, n_1)c(m_2, n_2) + 16f(m_1, n_1)f(m_2, n_2)
$$
$$
x = 4f(m_1, n_1)(
```


```md
# Замечание о c(m,n) ± 4f(m,n)
### Info type
3_tfmn
### Keywords
~Dir16Замечание, ~неполные квадраты, ~квадратный магический квадрат, ~замечание
### Text
Также отметим, что $c(m, n) \pm 4f(m, n)$ — это квадратные числа, так как это выражение ни что иное, как задание интересной тройки. Если мы разделим всё это выражение на $c(m, n)$, получим $1 \pm 4dir(m, n)$. $\frac{c(m, n)}{c(m, n)}$ — средний элемент интересной тройки, отсюда: $1 \pm 4dir(m, n)$ — это рациональный квадрат. Это даёт нам право не беспокоиться по этому поводу при решении подобных уравнений.
```
```md
# Частные случаи 6/9
### Info type
3_tfmn
### Keywords
~Dir17Частные, ~неполные квадраты, ~квадратный магический квадрат, ~частные
### Text
Следующие квадраты — 6/9, в общем виде так просто не решаются. Говоря точнее, мы не умеем решать их в общем виде. Таковых 5 групп: две из них заданы парой интересных троек, остальные три задаются тремя тройками. Перечислим их и дадим комментарии:
$$
\begin{matrix}
X & O & X \\
X & X & O \\
O & X & O
\end{matrix}
$$
ACDEHJ-квадрат. Задаётся системой
$$
\begin{cases}
x = 4E^2dir(m_1, n_1) \\
x = 4C^2dir(m_2, n_2)
\end{cases}
$$
$$
\begin{matrix}
O & X & X \\
X & O & X \\
X & O & O
\end{matrix}
$$
BCDFGH-квадрат. Задаётся системой
$$
\begin{cases}
x = 4G^2dir(m_1, n_1) \\
x = 4C^2dir(m_2, n_2)
\end{cases}
$$
Как видно из системы, аналогичен первому приведённому квадрату. Если m(E, x, y) — ACDEHJ-квадрат, то m(E, x, 2y) — BCDFGH. А потому имеет смысл рассматривать лишь ACDEHJ.
$$
\begin{matrix}
X & O & X \\
X & X & O \\
O & X & O
\end{matrix}
$$
ACDEFH-квадрат. Задаётся системой
$$
\begin{cases}
x = 4C^2dir(m_1, n_1) \\
y = 4A^2dir(m_2, n_2) \\
x + y = 4E^2dir(m_3, n_3)
\end{cases}
$$
Представляет собой пересечение ACDFH-квадрата и двух ABEFH-квадратов.
$$
\begin{matrix}
X & X & O \\
X & X & O \\
O & X & O
\end{matrix}
$$
ABDEFH-квадрат. Задаётся системой
```
```md
# Частные случаи 6/9 (продолжение)
### Info type
3_tfmn
### Keywords
~Dir18Частные, ~неполные квадраты, ~квадратный магический квадрат, ~частные
### Text
$$
\begin{cases}
y = 4A^2dir(m_1, n_1) \\
y - x = 4E^2dir(m_2, n_2) \\
y + x = 4E^2dir(m_3, n_3)
\end{cases}
$$
Является пересечением BDEFH-квадрата и двух ABEFH-квадратов.
$$
\begin{matrix}
X & X & O \\
X & O & X \\
O & X & O
\end{matrix}
$$
ABDEHJ-квадрат. Задаётся системой
$$
\begin{cases}
y = 4J^2dir(m_1, n_1) \\
x = 4E^2dir(m_2, n_2) \\
y - x = 4E^2dir(m_3, n_3)
\end{cases}
$$
Является пересечением ABEHJ-квадрата, ABDEJ-квадрата и BDEHJ-квадрата.
Решение последних трёх квадратов приводит, в конце концов, к слишком сложным уравнениям, для непереборного решения которых у нас не хватает математического аппарата. Первые два также не решены в общем виде, однако за последние два месяца мы значительно продвинулись в этой области.
```
```md
# Определение fmn-функции
### Info type
3_tfmn
### Keywords
~fmn1Определение, ~fmn-функция, ~tfmn-функция, ~магические квадраты
### Text
Функция $f(m, n) = mn(m - n)(m + n)$, которая в прошлом разделе давалась как числитель dir-функции, теперь имеет особую роль. Поскольку данная запись читается как "эф-эм-эн", называется эта функция также — fmn.
```
```md
# Определение t-функции
### Info type
3_tfmn
### Keywords
~fmn2Определение, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~t-функция
### Text
Как было сказано, квадратные числа в данном случае для нас не имеют значения. По этой причине мы вводим другую функцию — t(n), которая данное число n отображает в n, делённое на наибольший квадрат, на который оно может быть разделено. Задать её можно следующей системой:
$$t(p) = p \text{ для всякого простого } p$$
$$t(p^2) = 1 \text{ для всякого простого } p$$
$$t(mn) = t(m)t(n) \text{ для всяких } m, n: \text{НОД}(m, n) = 1$$
```
```md
# Определение tfmn-функции
### Info type
3_tfmn
### Keywords
~fmn3Определение, ~fmn-функция, ~tfmn-функция, ~магические квадраты
### Text
$$tf(m, n) = t(f(m, n))$$ — всего лишь функция, введённая для более удобной записи.
```
```md
# Пример вычисления tfmn
### Info type
3_tfmn
### Keywords
~fmn4Пример, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~пример
### Text
Например,
$$tf(9, 2) = t(9 \cdot 2 \cdot 7 \cdot 11) = t(2 \cdot 7 \cdot 11) = t(9 \cdot 25 \cdot 2 \cdot 7 \cdot 11) = t(18 \cdot 7 \cdot 11 \cdot 25) = tf(18, 7)$$
```
```md
# Уравнение для ACDEHJ
### Info type
3_tfmn
### Keywords
~fmn5Уравнение, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~ACDEHJ
### Text
Теперь подставим это в наше уравнение
$$E^2 f(9, 2) c(18, 7) = C^2 f(18, 7) c(9, 2)$$
$$E^2 \cdot (9 \cdot 2 \cdot 7 \cdot 11) \cdot (18^2 + 7^2)^2 = C^2 \cdot (18 \cdot 7 \cdot 11 \cdot 25) \cdot (9^2 + 2^2)^2$$
$$E^2 \cdot 373^2 = C^2 \cdot 5^2 \cdot 85^2$$
Откуда выразим:
$$
\begin{cases}
E^2 = 5^2 \cdot 85^2 \\
C^2 = 373^2
\end{cases}
$$
А дальше:
$$E^2 = 5^2 \cdot 85^2 = 180625$$
$$x = 4E^2 \cdot dir(9, 2) = \frac{4 \cdot 5^2 \cdot 85^2}{85^2} \cdot (9 \cdot 2 \cdot 7 \cdot 11) = 138600$$
$$y = E^2 - C^2 = 5^2 \cdot 85^2 - 373^2 = 41496$$
И проверяем:
$$
m(180625, 138600, 41496) =
\begin{pmatrix}
319225 & 83521 & 139129 \\
529 & 180625 & 360721 \\
222121 & 277729 & 42025
\end{pmatrix}
=
\begin{pmatrix}
565^2 & 83521 & 373^2 \\
23^2 & 425^2 & 360721 \\
222121 & 527^2 & 205^2
\end{pmatrix}
$$
Действительно, мы получили квадрат 6/9 запланированного вида. На самом деле, здесь мы видим уникальный квадрат 7/9, так как $83521 = 289^2$, однако цель данного примера была в демонстрации tfmn-подхода к генерации квадратов 6/9.
```
```md
# Замечание о количестве квадратов
### Info type
3_tfmn
### Keywords
~fmn6Замечание, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~замечание
### Text
Отметим также, что 6-квадратных квадратов указанного вида значительно больше, чем 5-квадратных квадратов, например, вида ACEGJ. Так, при подстановке в систему ACEGJ-квадрата значений $m_1 = 9, n_1 = 2, m_2 = 18, n_2 = 7$, мы получим квадрат m(1005207025, 771331176, 1001385000), который имеет магическую константу практически в 6000 раз большую, чем ACDEHJ-квадрат при тех же параметрах.
```
```md
# Гипотеза о делимости Е
### Info type
3_tfmn
### Keywords
~fmn7Гипотеза, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~гипотеза
### Text
Это может быть тем, что для ACEGJ-квадрата E обязано делится на как минимум две суммы квадратов. Для ACDEHJ-квадрата достаточно одной суммы квадратов. Тем не менее, решение последнего в общем виде может дать намного более мощный инструментарий для работы с полным квадратным квадратом.
```
```md
# Свойства fmn
### Info type
3_tfmn
### Keywords
~fmn8Свойства, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~свойства
### Text
Конечно, мы хотим иметь решение уравнения
$$tfmn(a, b) = tfmn(c, d)$$
в общем виде, чтобы научиться решать ACDEHJ и BCDFGH-квадраты. Однако такого решения мы не имеем. Однако мы можем заметить несколько важных свойств fmn и tfmn функций, а также найти большое количество частных решений.
1.  $f(b, a) = f(-a, b) = f(a, -b) = -f(a, b)$
2.  $f(a, a) = f(a, -a) = f(a, 0) = 0$
3.  $f(ka, kb) = k^4f(a, b)$
4.  $f(a + b, a - b) = 4f(a, b)$
5.  $f(a + b, a) = f(a + b, b) + f(a, b)$
6.  $\{f(a, b) = f(a, c); b \ne c; \text{НОД}(a, b) = \text{НОД}(a, c) = 1\} \Leftrightarrow \{a = m^2 + mn + n^2; b = (n - m)(n + m); c = m(n + 2n)\}$
```
```md
# Доказательство свойства 6
### Info type
7_Approvement
### Keywords
~fmn9Доказательство, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~свойства, ~доказательство
### Approves
~~fmn8Свойства
### Text
Поскольку первые пять свойств следуют напрямую из определения функции fmn, мы не станем приводить их доказательство. Для последнего же свойства мы не можем этого не сделать:
$$f(a, b) = f(a, c)$$
$$ab(a^2 - b^2) = ac(a^2 - c^2)$$
$$a^2b - b^3 = a^2c - c^3$$
$$a^2b - a^2c = b^3 - c^3$$
$$a^2(b - c) = (b - c)(b^2 + bc + c^2)$$
$$a^2 = b^2 + bc + c^2$$
$$a^2 = (b + c)^2 - bc$$
$$bc = (b + c - a)(b + c + a)$$
Обозначим $a - b - c = k \Rightarrow a = b + c + k$
$$bc = -k(2b + 2c + k)$$
$$bc + 2kb + 2kc = -k^2$$
$$bc + 2kb + 2kc + 4k^2 = k^2 + 4k^2$$
$$(b + 2k)(c + 2k) = 3k^2$$
Далее из последнего уравнения отметим, что если $b + 2k$ и $c + 2k$ имеют общие множители, то не выполняется условие НОД(a, b) = НОД(a, c) = 1. Значит, они взаимно просты. И, значит, один из них имеет вид $n^2$, а другой $3m^2$, при этом неважно, какой из них чему соответствует. В таком случае, мы и приходим к следующему:
$$
\begin{cases}
b + 2k = n^2 \\
c + 2k = 3m^2 \\
3k^2 = 3n^2m^2
\end{cases}
$$
$$
\begin{cases}
b = n^2 - 2k \\
c = 3m^2 - 2k \\
k = nm
\end{cases}
\Leftrightarrow
\begin{cases}
b = n^2 - 2nm \\
c = 3m^2 - 2nm \\
a = 3m^2 - 3nm + n^2
\end{cases}
$$
Теперь введём замену $n' = m - n$:
$$
\begin{cases}
b = n^2 - 2nm \\
c = 3m^2 - 2nm \\
a = 3m^2 - 3nm + n^2
\end{cases}
\Leftrightarrow
\begin{cases}
b = m^2 - 2mn' + n'^2 - 2m^2 + 2mn' \\
c = 3m^2 - 2m^2 + 2mn' \\
a = 3m^2 - 3m^2 + 3mn' + m^2 - 2mn' + n'^2
\end{cases}
\Leftrightarrow
\begin{cases}
b = n'^2 - m^2 \\
c = m^2 + 2mn' \\
a = m^2 + mn' + n'^2
\end{cases}
$$
Итоговая система задаёт то же множество решений и практически не содержит коэффициентов, поэтому она предпочтительнее.
```
```md
# Свойства 1, 2, 3
### Info type
3_tfmn
### Keywords
~fmn10Свойства, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~свойства
### Text
Свойства 1, 2 указывают на то, что нам достаточно перебирать f(m, n) лишь при условии m > n > 0. Свойство 3 указывает на то, что достаточно рассматривать лишь fmn-функцию лишь от взаимно простых чисел.
```
```md
# Свойство 4
### Info type
3_tfmn
### Keywords
~fmn11Свойства, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~свойства
### Text
Из свойства 4 вытекает унарная операция над вектором $R_2(a, b) = (a + b, a - b)$ и обратная ей $R_{0.5}(a, b) = (\frac{a + b}{2}, \frac{a - b}{2})$. Заметим также, что $f(R_2(a, b)) = f(a, b)$. Заметим также, что $c(R_2(a, b)) = c(a, b)$, а потому мы не можем взять для генерации dir-квадрата пару векторов (a, b) и (a + b, a - b) — в таком квадрате будут повторяющиеся элементы. Тем не менее, $R_2$-переход имеет важную роль в теории fmn-функции. В частности, нам не нужно рассматривать пары нечётных чисел, ведь от них всегда можно сделать $R_{0.5}$ переход, и получить меньшую, уже рассмотренную пару.
```
```md
# odd-odd и odd-even
### Info type
3_tfmn
### Keywords
~fmn12odd, ~fmn-функция, ~tfmn-функция, ~магические квадраты
### Text
Для краткой записи, пары нечётных взаимно простых чисел мы будем называть odd-odd, а любую другую пару взаимно простых чисел odd-even.
```
```md
# Свойство 5
### Info type
3_tfmn
### Keywords
~fmn13Свойства, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~свойства
### Text
Также посвятим небольшую часть текста свойству № 5. В случае, если $2b > a$, мы можем применить его рекурсивно, и получить выражение
$$f(a + b, b) = f(a + b, a) + f(a, a - b) + f(b, a - b)$$
Далее, если $2a - 2b > b$, мы сможем вновь применить рекурсию. В общем же случае, длина цепочки тем больше, чем отношение a/b ближе к $\varphi$. Этот забавный факт пока не нашёл применения в теории квадратных квадратов, однако явно достоин внимания.
```
```md
# Определение линейного решения
### Info type
3_tfmn
### Keywords
~tfmn1Определение, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~линейное решение
### Text
Перейдём к более глубокому рассмотрению tfmn-уравнения. Назовём группу решений уравнения $tf(a, b) = tf(c, d)$ линейной, если
$$
\begin{cases}
c = \gamma(a, b) \\
d = \delta(a, b) \\
tf(x, y) = tf(\alpha(x, y), \beta(x, y)) \Leftrightarrow t(\alpha(x, y)) = t(\beta(x, y))
\end{cases}
$$
$$\alpha(x, y), \beta(x, y), \gamma(x, y), \delta(x, y) — \text{линейные комбинации } x, y$$
Например, $R_2$-переход является линейным решением, пусть и тривиальным.
```
```md
# F1-равенство
### Info type
3_tfmn
### Keywords
~tfmn2F1, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~F1-равенство
### Text
Другой пример линейной группы решений — это равенство
$$tf(m^2 - 2n^2, 6n^2) = tf(2m^2 - 4n^2, m^2 + 4n^2)$$
В действительности, если $a = m^2 - 2n^2, b = 6n^2, c = 2m^2 - 4n^2, d = m^2 + 4n^2$, то мы имеем:
$$c = 2a$$
$$d = a + b$$
При этом
$$f(a, b) = ab(a - b)(a + b)$$
$$f(2a, a + b) = 2a(a - b)(a + b)(3a + b)$$
То есть
$$tf(a, b) = tf(2a, a + b) \Leftrightarrow t(b) = t(2(3a + b))$$
Что в полной мере удовлетворяет условию линейного решения. Более того, выражение (1) — единственное решение уравнения $tf(a, b) = tf(2a, a + b)$ во взаимно простых числах. Докажем это.
```
```md
# Доказательство F1-равенства
### Info type
7_Approvement
### Keywords
~tfmn3Доказательство, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~F1-равенство, ~доказательство
### Approves
~~tfmn2F1
### Text
$$t(b) = t(2(3a + b))$$
$$m^2b = 2n^2(3a + b)$$
$$6n^2a = (m^2 - 2n^2)b$$
Из предположения о том, что a, b — взаимно простые числа, заметим, что b и 3a+b не имеют никаких общих делителей кроме, может быть, 3. Это означает, что и m, n не могут иметь никаких других общих множителей [кроме, может быть, 2]. В таком случае b делится на 3, а a не делится. Если же b не делится на 3, то на 3 делится $m^2 - 2n^2$, причём это возможно лишь тогда, когда и m, и n делятся на 3. В таком случае, в правой части 3 всегда будет входить в чётной степени, а в левой — в нечётной. Пришли к противоречию. b делится на 3, a m, n - взаимно просты. Очевидно, имеет смысл рассматривать лишь odd-even так как иначе в обеих частях равенства $tf(a, b) = tf(2a, a + b)$ мы можем совершить $R_{0.5}$-переход. В таком случае, если b не имеет делителем 2, то a делится на 2, и 3a+b нечётное. А значит, в левую часть выражения $m^2b = 2n^2(3a + b)$ 2 будет входить в чётной степени, а в правую часть — в нечётной. В конце концов, единственным решением оказывается $a = m^2 - 2n^2, b = 6n^2$.
```
```md
# Векторный переход F1
### Info type
3_tfmn
### Keywords
~tfmn4Переход, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~векторный переход
### Text
Векторный переход $(a, b) \rightarrow (2a, a + b)$ обозначим за $F_1$. То есть $F_1(a, b) = (2a, a + b)$. Выражение (1) назовём $F_1$-равенством.
```
```md
# F2- и F3-равенства
### Info type
3_tfmn
### Keywords
~tfmn5Переход, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~F2-равенство, ~F3-равенство
### Text
По аналогии введём $F_2(a, b) = (2a, a - b)$ и $F_3(a, b) = (a + b, b)$. Этим переходам соответствуют равенства:
$$tf(m^2 + 2n^2, 6n^2) = tf(2m^2 + 4n^2, m^2 - 4n^2)$$
$$tf(m^2 + 2n^2, m^2 - n^2) = tf(2m^2 + n^2, m^2 - n^2)$$
Несложно заметить, что все прочие линейные решения выражаются через $F_1, F_2, F_3, R_2$, а также элементарные переходы, описанные в свойствах 1-3 fmn-функции.
```
```md
# Замечание о F2
### Info type
3_tfmn
### Keywords
~tfmn6Замечание, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~F2-равенство
### Text
Также отметим, что $F_2$, на самом деле, является излишним решением, так как $F_2(a, b) = F_3(R_2(a, b))$. Автор принял решение сохранить его в данном материале для удобства, а также по той причине, что этим
```
```md
# F4-равенство
### Info type
3_tfmn
### Keywords
~tfmn7F4, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~F4-равенство
### Text
Следующее равенство по аналогии с предыдущими названо $F_4$, хоть и отличается по многим параметрам.
$$tf(m^2 + mn + n^2, m^2 - n^2) = tf(m^2 + mn + n^2, m^2 + 2mn)$$
Несложно заметить, что это равенство есть отражение свойства 6 функции fmn. Действительно, если равны f(a, b) и f(c, d), то равны и tf(a, b) и tf(c, d). Это выражение порождает немалое количество решений. Кроме того, оно не имеет общих решений, за исключением первых нескольких, с другими равенствами, так как для них отношение двух fmn равно $m^2 / n^2$, а для него оно всегда 1.
```
```md
# Графы решений
### Info type
3_tfmn
### Keywords
~tfmn8Графы, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~графы
### Text
На основе этого, мы можем строить целые графы решений. Так, tf(6, 1) и tf(5, 2) связаны через F2-переход. С другой стороны, $R_2(6, 1) = (7, 5)$, a $f(7, 5) = f(8, 7)$ — здесь уже применимо лишь F4-равенство. Таким образом, мы имеем и tf(5, 2) = tf(8, 7). Данный пример приведён лишь с целью объяснить идею графового представления решений и является надуманным, так как все три пары чисел могут быть связаны и просто через F4, однако в более сложных случаях мы будем разграничивать применяемые средства.
```
```md
# Проверка многочленов
### Info type
3_tfmn
### Keywords
~tfmn9Многочлены, ~fmn-функция, ~tfmn-функция, ~магические квадраты
### Text
Читатель, наверняка, заметил, что у F1-4-равенств имеется общее свойство: a, b, c, d в конце концов записываются квадратными трёхчленами, однако слагаемое mn появляется только лишь в F4. Почему бы в таком случае не попробовать поискать другие решения, основанные на том же принципе. Автор задался этим вопросом и программно проверил tfmn-равенства между всеми парами многочленов вплоть до суммы абсолютных значений коэффициентов, равной 20. Предполагается, что дополнением к этому материалу будет идти код, который может быть проверен любым желающим. Было найдено около 40 нетривиальных решений tfmn-уравнения, записываемых в общем виде через квадратные трёхчлены, и все они оказались частными случаями F1, F3 или F4-равенств. Отсюда слабая гипотеза: других решений tfmn-уравнения, записываемых в общем виде через квадратные трёхчлены, не существует.
```
```md
# F7-равенство
### Info type
3_tfmn
### Keywords
~tfmn10F7, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~F7-равенство
### Text
Последнее множество решений F7 [обозначения F5, F6 было решено оставить на случай, если найдутся более адекватные варианты], найденное автором этого материала, кардинально отличается от остальных. Связано оно с тем, как мы определяли fmn-функцию впервые. Напомним, 4f(a, b) есть ни что иное, как разность арифметической прогрессии трёх квадратных чисел со средним числом c(a, b) = $(a^2 + b^2)^2$. Отсюда:
$$tf(c(a, b), 4f(a, b)) = t(c(a, b) \cdot (c(a, b) - 4f(a, b)) \cdot (c(a, b) + 4f(a, b)) \cdot 4f(a, b)) = t(4f(a, b)) = tf(a, b)$$
И теперь в сокращённом варианте:
$$tf(a, b) = tf((a^2 + b^2)^2, 4f(a, b))$$
Это свойство, с одной стороны, воодушевляет тем, что ставит абсолютно каждому значению tfmn бесконечное множество решений. Оно может быть использовано при доказательстве очень большого количества теорем о tfmn-функции. С другой стороны, скорость, с которой растут значения fmn в данном случае, настолько велика, что F7 становится практически не применимым при генерации квадратов. Наименьший квадрат, получаемый таким образом, это ACEFGH, построенный на паре f(2, 1), f(25, 24). Следующий квадрат — это уже пара f(3, 2), f(169, 120). При увеличении a, b в k раз, $f(F_7(a, b))$ возрастёт в $k^{16}$ раз. Никаких прочих решений в общем виде пока что не найдено. Тем не менее, графовый подход позволяет насобирать достаточно большие группы решений. В малых числах в эти группы не входят лишь единичные
```
```md
# Правило поиска решений
### Info type
3_tfmn
### Keywords
~tfmn11Поиск, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~поиск
### Text
решения. Как правило, поиск других решений требует решения уравнений в целых числах как минимум четвёртой степени. Наиболее привлекательные из неописанных в общем виде решений:
$$tf(43, 42) = tf(43, 8)$$
$$tf(128, 7) = tf(8, 7)$$
Более чем вероятно, что связаны не только пары чисел с одинаковыми tfmn, но и равенства с различными tfmn.
```
```md
# Ограничения на 7-квадраты
### Info type
3_tfmn
### Keywords
~tfmn12Ограничения, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~ограничения
### Text
Но пока мы ограничены этими группами решений. К счастью, каждое из этих решений отображается на тройку E, x, y без деления на НОД и других сложностей. Выразим их все по очереди, начиная с конца. Напомним, система для квадрата 6/9 выглядит следующим образом:
$$
\begin{cases}
x = 4E^2dir(m_1, n_1) \\
E^2 f(m_1, n_1)c(m_2, n_2) = H^2 f(m_2, n_2)c(m_1, n_1) \\
y = H^2 - E^2
\end{cases}
$$
Для F7:
$$
\begin{cases}
H^2 \cdot f(a, b) \cdot ((a^2 + b^2)^4 + 16(f(a, b))^2)^2 = E^2 \cdot 4f(a, b)(a^2 + b^2)^2 \cdot (a^2 + 2ab - b^2)^2 \cdot (a^2 - 2ab - b^2)^2 \\
E^2 = ((a^2 + b^2)^4 + 16(a^3b - ab^3)^2)^2 \\
H^2 = 4(a^2 + b^2)^4 (a^2 + 2ab - b^2)^2(a^2 - 2ab - b^2)^2 \\
x = 16(a^2
```

```md
# Ограничения на 7-квадраты (продолжение)
### Info type
3_tfmn
### Keywords
~tfmn13Ограничения, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~ограничения
### Text
Заметим, что здесь $E^2, E^2 - x, E^2 + x$ нечётные, $E^2 + y, E^2 + y - x, E^2 + y + x$ делятся на 4, а значит неизбежно $E^2 - y, E^2 - y - x, E^2 - y + x$ делятся на 2 и не делятся на 4. То есть все 6-квадраты такого вида никогда не будут 7-квадратами. Но мы можем задать квадрат и наоборот, системой:
$$
\begin{cases}
E^2 = 4(a^2 + b^2)^4 (a^2 + 2ab - b^2)^2(a^2 - 2ab - b^2)^2 \\
H^2 = ((a^2 + b^2)^4 + 16(a^3b - ab^3)^2)^2 \\
x = 16(a^2 + b^2)^2 (a^2 + 2ab - b^2)^2(a^2 - 2ab - b^2)^2 \\
y = (a^2 + 6a^2b^2 - 3b^4)(3a^4 - 6a^2b^2 - 3a^4)(a^8 - 28a^6b^2 + 6a^4b^4 - 28a^2b^6 + b^8)
\end{cases}
$$
Но в таком случае, у нас в каждой строке и в каждом столбце будут стоять два квадрата, один кратный четырём, другой нечётный. Магическая константа в этом квадрате кратна 4, а потому третье число в рассматриваемой строке будет иметь вид 4k+3, то есть не может быть квадратом. Что же касается третьего случая ABDFHJ-квадрата, его мы в принципе не можем построить [имеется ввиду, минимальный], так как для него требуется, чтобы те две прогрессии квадратов, на которых он строится, были нечётными, что в данном случае не выполняется. Таким образом, ни один из 6-квадратов, задающихся через F7, не может быть 7-квадратом. Тем не менее, роль F7 в нашей теории не ограничивается лишь генерацией, и это мы увидим в следующем параграфе.
```
```md
# F4-равенство в общем виде
### Info type
3_tfmn
### Keywords
~tfmn14F4, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~F4-равенство
### Text
Для F4:
$$
H^2 \cdot f(a, b) \cdot ((m^2 + mn + n^2)^2 + (m^2 - n^2)^2)^2 =
E^2 \cdot f(a, b) \cdot ((m^2 + mn + n^2)^2 + (m^2 + 2mn)^2)^2
$$
$$
\begin{cases}
E^2 = ((m^2 + mn + n^2)^2 + (m^2 - n^2)^2)^2 \\
H^2 = ((m^2 + mn + n^2)^2 + (m^2 + 2mn)^2)^2 \\
x = 4mn(m + n)(m - n)(m + 2n)(2m + n)(m^2 + mn + n^2) \\
y = n(2m + n)(2m^2 + n^2)(2m^2 + 2mn - n^2)(2m^2 + 4mn + 3n^2)
\end{cases}
$$
Здесь, однако, не учитывается тот факт, что $E^2, H^2$ не взаимно просты в общем случае.
```
```md
# Ограничение на чётность
### Info type
3_tfmn
### Keywords
~tfmn15Чётность, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~чётность
### Text
Опять же, требование к нечётности всех элементов квадрата удовлетворится тогда и только тогда, когда E будет нечётно, а x, y чётны. В данном случае, x всегда делится на 4. Чётность y зависит только от n. В таком случае, оно должно быть чётным. y будет делиться по крайней мере на 32. А x — как минимум на 16. А значение E независимо от чётности m будет чётным, что неудовлетворяет требованию минимального квадрата.
```
```md
# Сокращение на 4
### Info type
3_tfmn
### Keywords
~tfmn16Сокращение, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~сокращение
### Text
Тем не менее, при нечётном m (а таковым оно должно быть ввиду взаимной простоты с n), степень вхождения двойки в E, как можно заметить, не превысит второй (сумма нечётных квадратов в квадрате). А значит, мы сможем сократить квадрат на 4 и потенциально получить минимальный.
```
```md
# Решения Веселовского
### Info type
6_Related_Works
### Keywords
~Литература1Веселовский, ~магические квадраты, ~литература, ~Веселовский
### Text
Математики и любители со всего мира, решающие ту же проблему, что и мы, наверняка знакомы с сайтом http://www.multimagie.com/English/SquaresOfSquaresSearch.htm На этом сайте, кроме всего прочего, публикуются последние исследования в области магических квадратов. Считаем уместным в данном материале указать, как соотносится наше исследование с прочими.
1.  Аркадиус Велосовски из Польши опубликовал своё частное решение для 6/9:
    *   $w = 6n^2 + 6n + 2$
    *   $x = 2n + 1$
    *   $y = 3n^2 + 2n$
    *   $z = 3n^2 + 4n + 1$
$$
\begin{matrix}
(wz + xy)^2 & (wy - xz)^2 & (2y^2z^2)x^2 + (2z^2 - y^2)w^2 \\
x^2y^2 + w^2z^2 & 2(x^2y^2 + w^2z^2) - (wy + xz)^2 & (wy + xz)^2 \\
x^2z^2 + w^2y^2 & 2(x^2y^2 + w^2z^2) - (wy - xz)^2 & (wz - xy)^2
\end{matrix}
$$
Обобщим до
$$w = 6n^2 + 6mn + 2m^2$$
$$x = 2mn + m^2$$
$$y = 3n^2 + 2mn$$
$$z = 3n^2 + 4n + m^2$$
В таком случае,
$$H^2 = x^2z^2 + w^2y^2 = (18n^4 + 30n^3m + 19n^2m^2 + 6nm^3 + m^4)^2$$
$$E^2 = x^2y^2 + w^2z^2 = (18n^4 + 42n^3m + 37n^2m^2 + 14nm^3 + 2m^4)^2$$
$$Y = m(2n + m)(6n^2 + 4mn + m^2)(6n^2 + 6mn + m^2)(6n^2 + 8mn + 3m^2)$$
$$X = 4mn(m + n)(2m + n)(3m + n)(3m + 2n)(3m^2 + 3mn + 1)$$
Подставив в систему для F4 n = 2n' + m', m = -n', получим систему выше, с точностью до знака в выражении для Y. Это означает всего лишь то, что Аркадиус рассматривал магические квадраты-отражения наших. Таким образом, решение Аркадиуса — есть частный случай F4, а конкретно, случай при n = 2x + 1, m = -x.
```
```md
# Рекурсивное решение Веселовского
### Info type
6_Related_Works
### Keywords
~Литература2Веселовский, ~магические квадраты, ~литература, ~Веселовский, ~рекурсия
### Text
2. Другое решение от Аркадиуса было найдено раньше, а соотнести его с нашим исследованием будет сложнее, так как оно записывается рекурсивно:
Received December 20 and 22. 2019
One year after his above parametric solutions of 3x3 magic squares of 5 squared integers, one more squared integer! Arkadiusz Wesolowski found this marvelous parametric solution of 3x3 magic squares of 6 squared integers:
$$x = \frac{[(3 + \sqrt{3}) \cdot (2 + \sqrt{3}) + 1 + (3 - \sqrt{3}) \cdot (2 - \sqrt{3}) + 1]}{6}$$
$$y = \frac{[(3 + \sqrt{3}) \cdot (2 + \sqrt{3}) + (3 - \sqrt{3}) \cdot (2 - \sqrt{3})]}{6}$$
$$z = 2 \cdot \frac{[(1 + \frac{\sqrt{3}}{2}) + 1 - (1 - \frac{\sqrt{3}}{2}) + 1]}{\sqrt{3}}$$
$$
\begin{matrix}
(xy - z)^2 & (x + yz)^2 & x^2z^2 + y^2 \\
(xz - y)^2 & x^2 + y^2z^2 & (xy + z)^2 \\
(yz - x)^2 & (x^2 + y^2)(z^2 + 1) / 2 & (xz + y)^2
\end{matrix}
$$
The three first examples of 3x3 magic squares, constructed with n = 1 (-> (x, y, z) = (11, 3, 4)), n = 2 (-> (41, 11, 15)), and n = 3 (-> (153, 41, 56)):
$$
\begin{matrix}
29^2 & 47^2 & 265 \\
23^2 & 1105 & 41^2 \\
1945 & 12 & 37^2
\end{matrix}
$$
$$
\begin{matrix}
4362 & 6262 & 28906 \\
2062 & 203626 & 6042 \\
378346 & 1242 & 4662
\end{matrix}
$$
$$
\begin{matrix}
62172 & 86092 & 5295025 \\
24492 & 39353665 & 85272 \\
73412305 & 21432 & 63292
\end{matrix}
$$
When n is an even positive number, we can prove that the cells in red can't be squared integers. His quick search of odd n <= 2*10^5 didn't produce 3x3 magic squares with seven, eight, or nine square numbers. But maybe a larger odd n?
This was not given by Arkadiusz, but x, y, z can be easily computed with these recurrence formulas:
$$
\begin{cases}
x(0) = 3 \\
y(0) = 1 \\
z(0) = 1
\end{cases}
$$
$$
\begin{cases}
x(n) = 3x(n - 1) + 2z(n - 1) \\
y(n) = x(n - 1) \\
z(n) = x(n - 1) + z(n - 1)
\end{cases}
$$
Пусть E, X, Y — определяющие по нашей теории квадрат параметры. Заметим, что
$$E = \frac{(x^2 + y^2)(z^2 + 1)}{2}$$
$$Y = A - H = (xy - z)^2 - (yz - x)^2 = (x^2 - z^2)(y^2 - 1)$$
$$Y = F - A = (xz - y)^2 - (xy - z)^2 = (x^2 - y^2)(z^2 - 1)$$
$$X = \frac{(xy + z)^2 - (xy - z)^2}{2} = 4xyz$$
$$Y = (9x^2 + 12xz + 4z^2)$$
Теперь выпишем первые несколько значений, чтобы узреть красоту взаимосвязи:
$$
\begin{matrix}
x & y & z & E & X & Y \\
3 & 1 & 1 & 10 & 6 & 0 = 4f(1, 1) = 4f(2, 0) \\
11 & 3 & 4 & 1105 & 264 & 840 = 4f(5, 2) = 4f(6, 1) \\
41 & 11 & 15 & 203626 & 13530 & 174720 = 4f(20, 6) = 4f(21, 5) \\
153 & 41 & 56 & 39353665 & 702576 & 34058640 = 4f(76, 21) = 4f(77, 20) \\
571 & 153 & 209 & 15264674900 & 36517734 & 6609482880 = 4f(285, 77) = 4f(286, 76)
\end{matrix}
$$
Заметим, что $Y = 4f(\frac{x - 1}{2}, \frac{y + 1}{2}) = 4f(\frac{x + 1}{2}, \frac{y - 1}{2})$ и докажем. Но прежде докажем, что $2z = x - y$. Для начального случая верно: $2z_0 = 2 = 3 - 1 = x_0 - y_0$. Для последующих также верно: $2z_{n + 1} = 2x_n + 2z_n = (3x_n + 2z_n) - x_n = x_{n + 1} - y_{n + 1}$.
$$z_{n + 1} = \frac{x_{n + 1} - y_{n + 1}}{2}$$
Теперь, избавившись от 2, можем переписать выражения выше:
```
```md
# Выражения для Y
### Info type
6_Related_Works
### Keywords
~Литература3Выражения, ~магические квадраты, ~литература, ~Веселовский
### Text
$$Y = (x^2 - z^2)(y^2 - 1) = (x - z)(x + z)(y - 1)(y + 1) =$$
$$= \frac{x - y}{2} \cdot \frac{x + y}{2} \cdot (y - 1)(y + 1) = \frac{x - y}{2} \cdot (\frac{x + y}{2} - 1)(\frac{x + y}{2} + 1)$$
Или
$$Y = \frac{1}{4}(x + y)(3x - y)(y - 1)(y + 1)$$
$$Y = \frac{1}{4}(x - 3y)(x + y)(x - 1)(x + 1)$$
Поскольку эта публикация не раз проверялась, мы позволим себе не доказывать эквивалентность двух выражений, записанных выше, для конкретной системы — без их равенства не может существовать ни один такой магический квадрат.
```
```md
# Тождества для рекурсии
### Info type
7_Approvement
### Keywords
~Литература4Тождества, ~магические квадраты, ~литература, ~Веселовский, ~тождество
### Text
Поэтому для данной рекурсии мы можем считать тождеством
$$\frac{1}{4}(x + y)(3x - y)(y - 1)(y + 1) = \frac{1}{4}(x - 3y)(x + y)(x - 1)(x + 1)$$
$$(3x - y)(y - 1)(y + 1) = (x - 3y)(x - 1)(x + 1)$$
$$(3x - y)(y^2 - 1) = (x - 3y)(x^2 - 1)$$
$$3xy^2 - 3x - y^3 + y = x^3 - x - 3x^2y + 3y$$
$$x^3 - 3xy^2 - 3x^2y + y^3 = -2x - 2y$$
$$(x + y)(x^2 - xy + y^2) - 3xy(x + y) = -2(x + y)$$
$$x^2 - xy + y^2 - 3xy = -2$$
$$x^2 - 4xy + y^2 + 2 = 0$$
$$x^2 + y^2 = 4xy - 2$$
Мы хотим доказать, что
$$Y = 4f(\frac{x - 1}{2}, \frac{y + 1}{2}) = \frac{1}{4}(x - 1)(y + 1)(x + y)(x - y - 2)$$
Приравняем формулу для Y выше к этому выражению:
$$\frac{1}{4}(x + y)(3x - y)(y - 1)(y + 1) = \frac{1}{4}(x - 1)(y + 1)(x + y)(x - y - 2)$$
$$(3x - y)(y - 1) = (x - 1)(x - y - 2)$$
$$3xy - 3x - y^2 + y = x^2 - xy - 2x - x + y + 2$$
$$x^2 - 4xy + y^2 + 2 = 0$$
$$x^2 + y^2 = 4xy - 2$$
Последнее выражение, как и было сказано, является тождеством. Если оно не верно, магический квадрат просто не будет магическим. Аналогично доказывается, что
$$Y = 4f(\frac{x + 1}{2}, \frac{y - 1}{2})$$
Теперь нам остаётся заметить, что, если
$$f(\frac{x - 1}{2}, \frac{y + 1}{2}) = f(\frac{x + 1}{2}, \frac{y - 1}{2})$$
то
$$f(x + y, x - y + 2) = f(x + y, x - y - 2) \text{ [4 свойство fmn — функции]}$$
А это, по 6 свойству fmn-функции, ничто иное как частный случай F4.
Заметим, что рассматриваемые квадраты — это квадраты вида ABDFHJ, которые задаются системой:
```
```md
# Сокращение выражений
### Info type
7_Approvement
### Keywords
~Литература5Сокращение, ~магические квадраты, ~литература, ~Веселовский, ~сокращение
### Text
$$
\begin{cases}
Y = 4dir(m_1, n_1) \cdot A^2 \\
Y = 4dir(m_2, n_2) \cdot J^2
\end{cases}
$$
и никак иначе. При таком раскладе, чтобы окончательно убедиться в том, что данная формула целиком покрывается случаем F4 для ABDFHJ-квадратов, необходимо показать, что
$$A^2 = (\frac{x - 1}{2})^2 + (\frac{y + 1}{2})^2 = \frac{1}{4}(x^2 - 2x + 1 + y^2 + 2y + 1) = \frac{1}{4}(2xy + 2y - 2x) = \frac{1}{2}(xy + y - x)$$
$$J^2 = (\frac{x + 1}{2})^2 + (\frac{y - 1}{2})^2 = \frac{1}{4}(x^2 + 2x + 1 + y^2 - 2y + 1) = \frac{1}{4}(2xy - 2x + 2y) = \frac{1}{2}(xy - x + y)$$
$$A^2 = \frac{1}{2}(xy + y - x)$$
$$J^2 = \frac{1}{2}(xy - x + y)$$
В итоге,
$$A = xy + \frac{y - x}{2}$$
$$J = xy + \frac{x - y}{2}$$
При том, что по определению,
$$A = xy - z$$
$$J = xy + z$$
А мы выяснили, что $z = \frac{x - y}{2}$. То есть действительно
$$Y = 4dir \cdot \frac{(x - 1)(y + 1)}{2}$$
$$Y = 4dir \cdot \frac{(x + 1)(y - 1)}{2}$$
$$f(x + y, x - y - 2) = f(x + y, x - y + 2)$$
Этот случай целиком охватывается через решение F4.
```
```md
# Замечания о других исследованиях
### Info type
6_Related_Works
### Keywords
~Литература6Другие, ~магические квадраты, ~литература, ~другие исследования
### Text
Далее скажем по несколько слов о нескольких других исследованиях
Received September 22, 2017
Joseph Hurban, when he was student tutor at TCNJ (College of New Jersey, USA), sent this nice formula producing 3x3 magic squares of 5 squares:
$$
\begin{matrix}
(10z^2 + 20z + 5)^2 & (2z^2 + 2z + 1)^2 & b \\
c & (10z^2 + 10z + 5)^2 & g \\
h & (10z^2 - 5)^2 & (14z + 14z + 7)^2
\end{matrix}
$$
$$b = 72(2z^2 + 1)^2 - 4z(2z + 101z + 1)$$
$$c = (2z^2 + 1)^2 + 8z(26z^2 + 38z + 13)$$
$$g = 72(2z^2 + 1)^2 + 8z(24z^2 - 13z + 12)$$
$$h = (2z^2 + 1)^2 + 4z(102z^2 + 151z + 51)$$
Is it possible to obtain supplemental squared integers in cells b, c, g, and h? With a MATLAB program, he tried to find solutions, and from z = 0 to 1,000,000, found five solutions:
*   z = 0: b, c, g, h are squared integers, but the solution does not use unique integers
*   z = 1: b, c, g, h are squared integers, but the solution does not use unique integers
*   z = 3: $c = 95^2$, producing a 3x3 magic square of 6 squares
*   z = 10: $c = 529^2$, producing a 3x3 magic square of 6 squares
*   z = 12: $h = 937^2$, producing a 3x3 magic square of 6 squares
Examples with z = 1, 2, 3:
$$
\begin{matrix}
35^2 & 5^2 & 25^2 \\
85^2 & 2281 & 3169 \\
155^2 & 13825 & 95^2
\end{matrix}
$$
$$
\begin{matrix}
52^2 & 25^2 & 35^2 \\
132 & 65^2 & 91^2 \\
25^2 & 125^2 & 175^2
\end{matrix}
$$
$$
\begin{matrix}
25^2 & 35^2 & 5^2 \\
5281 & 6169 & 35^2 \\
22225 & 17425 & 85^2
\end{matrix}
$$
I checked that there is no other solution with more than 5 squared integers for any z < $10^{10}$. Это, очевидно, частный случай ABEHJ — квадратов. Все решения таких квадратов удовлетворяют системе
$$
\begin{cases}
x = 4dir(m_1, n_1)E^2 \\
y - x = 4dir(m_2, n_2)E^2
\end{cases}
$$
Формула Жозефа пропускает, например, квадрат для
```
```md
# Примеры квадратов Жозефа
### Info type
6_Related_Works
### Keywords
~Литература7Примеры, ~магические квадраты, ~литература, ~Жозеф
### Text
$$m_1 = 3, n_1 = 4, m_2 = 3, n_1 = 1$$
$$
\begin{matrix}
17^2 & 5^2 \cdot 7^2 & 19^2 \\
17 \cdot 41 & 5^4 & 7 \cdot 79 \\
7 \cdot 127 & 5^2 & 31^2
\end{matrix}
$$
И для $m_1 = 3, n_1 = 1, m_2 = 3, n_1 = 4$:
$$
\begin{matrix}
5^2 \cdot 7^2 & 17^2 & 19^2 \\
-239 & 5^4 & 1489 \\
7 \cdot 127 & 31^2 & 5^2
\end{matrix}
$$
```
```md
# Ещё решения Веселовского
### Info type
6_Related_Works
### Keywords
~Литература8Веселовский, ~магические квадраты, ~литература, ~Веселовский
### Text
4. Arkadiusz Wesolowski, Poland, found two parametric solutions of 3x3 magic squares of 5 squared integers. With n >= 1, let
$$x = -1 + \frac{[(sqrt(2)/2) \cdot ((3 + 2 \cdot sqrt(2)) - (3 - 2 \cdot sqrt(2))) + (3 + 2 \cdot sqrt(2)) + (3 - 2 \cdot sqrt(2))]}{2}$$
Or equivalent, the value of x can also be obtained with this recurrence formula:
$$x = a(n) = 6 \cdot a(n - 1) - a(n - 2) + 4, \text{starting with } a(0) = 0 \text{ and } a(1) = 4$$
Then we obtain this magic square, the integers in black being squared integers:
$$
\begin{matrix}
17x^4 + 44x^3 + 34x^2 + 10x + 1 & 2x^4 + 8x^3 + 11x^2 + 6x + 1 & 8x^4 + 20x^3 + 21x^2 + 8x + 1 \\
9x^2 + 6x + 1 & 9x^4 + 24x^3 + 22x^2 + 8x + 1 & 18x^4 + 48x^3 + 35x^2 + 10x + 1 \\
10x^4 + 28x^3 + 23x^2 + 8x + 1 & 16x^4 + 40x^3 + 33x^2 + 10x + 1 & x^4 + 4x^3 + 10x^2 + 6x + 1
\end{matrix}
$$
First examples with n = 1 (-> x = 4) and n = 2 (-> x = 28):
$$
\begin{matrix}
775^2 & 13^2 & 475^2 \\
11441977 & 85^2 & 6779473 \\
35^2 & 65^2 & 85^2
\end{matrix}
$$
$$
\begin{matrix}
3697 & 91^2 & 697 \\
1189^2 & 2465^2 & 3277^2 \\
5372977 & 3485^2 & 710473
\end{matrix}
$$
The other parametric solution is a derivative of the first one above. Again with n >= 1:
$$x = 1 + \frac{[(sqrt(2)/2) \cdot ((3 + 2 \cdot sqrt(2)) - (3 - 2 \cdot sqrt(2))) + (3 + 2 \cdot sqrt(2)) + 2 \cdot sqrt(2)]}{2}$$
or
$$x = a(n) = 6 \cdot a(n - 1) - a(n - 2) - 4, \text{starting with } a(0) = 2 \text{ and } a(1) = 6$$
$$
\begin{matrix}
17x^4 - 44x^3 + 34x^2 - 10x + 1 & 2x^4 - 8x^3 + 11x^2 - 6x + 1 & 8x^4 - 20x^3 + 21x^2 - 8x + 1 \\
9x^2 - 6x + 1 & 9x^4 - 24x^3 + 22x^2 - 8x + 1 & 18x^4 - 48x^3 + 35x^2 - 10x + 1 \\
10x^4 - 28x^3 + 23x^2 - 8x + 1 & 16x^4 - 40x^3 + 33x^2 - 10x + 1 & x^4 - 4x^3 + 10x^2 - 6x + 1
\end{matrix}
$$
First examples with n = 1 (-> x = 6) and n = 2 (-> x = 30):
$$
\begin{matrix}
1369^2 & 17^2 & 769^2 \\
35^2 & 85^2 & 115^2 \\
6757 & 119^2 & 757
\end{matrix}
$$
$$
\begin{matrix}
12612301 & 89^2 & 7364461 \\
1189^2 & 2581^2 & 3451^2 \\
5958661 & 3649^2 & 710821
\end{matrix}
$$
Такой же частный случай для BDEFH — квадрата
```
```md
# Связь t-функции и fmn
### Info type
3_tfmn
### Keywords
~tfmn17Связь, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~связь
### Text
Связка t-функции и fmn-функции даёт возможности рассуждать о факторизации tfmn-функции. Во-первых, tfmn ≠ 1 при любых m, n. Этот факт известен как теорема Ферма в прямоугольном треугольнике, и доказывается методом бесконечного спуска. Аналогично, но чуть сложнее доказывается tfmn ≠ 2.
```
```md
# Случай tfmn = p
### Info type
3_tfmn
### Keywords
~tfmn18Случай, ~fmn-функция, ~tfmn-функция, ~магические квадраты, ~простое
### Text
Во-вторых, рассмотрим случай, когда $tfmn = p$, где p — любое простое. Это означает, что из чисел a, b, a+b, a-b, делящих f(a, b) — три квадратных числа. Мы, безусловно, не можем утверждать, будет ли итоговое значение t-функции простым или нет, но точно можем утверждать, что других случаев нет.
```
```md
# Случай 1
### Info type
3_tfmn
### Keywords
~tfmn19Случай, ~fmn-функция, ~tfmn-функция, ~магические квадраты
### Text
Переберём все случаи:
1. $$
\begin{cases}
a = X^2 \\
b
```


```md
# Магический квадрат
### Info type
0_Contents
### Keywords
~Главное1Определение, ~магические квадраты, ~определение
### Text
Магический квадрат определяют как квадрат $N \times N$, составленный из различных натуральных чисел, так, что сумма значений в каждой строке, каждом столбце и каждой диагонали равна одному и тому же числу.
```

```md
# Полумагический квадрат
### Info type
0_Contents
### Keywords
~Главное2Определение, ~полумагические квадраты, ~определение, ~магические квадраты
### Text
Если условие на диагонали в определении ~~Главное1Определение магического квадрата не накладывается, то такой квадрат называют полумагическим.
```

```md
# Нормальные магические квадраты
### Info type
0_Contents
### Keywords
~Главное3Определение, ~нормальные магические квадраты, ~определение, ~магические квадраты
### Text
Довольно часто в определение ~~Главное1Определение магического квадрата добавляется условие на то, что числа, из которых он составляется, должны быть от 1 до $N^2$. В частности, в [1, 2] рассматриваются именно такие магические квадраты и способы их построения при различных $N$. В современной литературе такие квадраты называются нормальными магическими квадратами.

**Ссылки:**
[1] Гарднер М. Математические головоломки и развлечения / пер. с англ. Ю. А. Данилова ; под ред. Я. А. Смородинского. - 2-е изд., испр. и доп. - М.: Мир, 1999.
[2] М. М. Постников, "Магические квадраты", М. Наука, 1964.
```

```md
# Обобщения магических квадратов
### Info type
0_Contents
### Keywords
~Главное4Обобщение, ~магические квадраты, ~магические кубы, ~обобщение
### Text
Магические квадраты хорошо обобщаются до магических кубов и объектов большей размерности, а на элементы квадратов можно ставить очень много различных условий (все простые / все – квадраты натуральных чисел / все - кубы и т.п.), поэтому спектр нерешённых задач, связанных с ними, велик.
```

```md
# Французский сайт о нерешенных проблемах
### Info type
6_Related_Works
### Keywords
~Литература1Источник, ~французский сайт, ~нерешенные проблемы, ~квадратный квадрат
### Text
[3] – французский сайт с англоязычной версией, представляющий наиболее полную базу любительских и научных статей для различных данных нерешённых проблем (часть из которых решена). К сожалению, могут возникнуть проблемы с подключением, так как сайт использует незащищённых протокол http вместо https. Также сайт не обновлялся с 2020 года, поэтому какая-то информация может быть не совсем актуальна. Однако на этом сайте приводятся решения задачи «квадратного квадрата» для всех размерностей, начиная с 4 × 4 и указывается, почему эти решения не могут быть обобщены на квадраты 3 × 3.

**Ссылка:**
[3] http://www.multimagie.com/
```

```md
# Задача поиска квадратного квадрата 3x3
### Info type
1_Main
### Keywords
~КвадратныйКвадрат1Задача, ~проблема квадратного квадрата, ~магические квадраты 3 на 3
### Text
Задаче поиска «квадратного квадрата» 3×3 значительное внимание уделяли несколько исследователей [4, 5], среди которых наиболее выделяются Lee Morgenstern, США и Arkadiusz Wesolowski, Польша, доказавшие и опубликовавшие часть свойств «квадратных квадратов», которые в будущем обнаружили и мы. Однако их публикации я не смог найти нигде, кроме как на указанном французском сайте ~~Литература1Источник [3].

**Ссылки:**
[4] Rabern, Landon W. (2003) "Properties of Magic Squares of Squares," Rose-Hulman Undergraduate Mathematics Journal: Vol. 4: Iss. 1, Article 3. Available at: https://scholar.rose-hulman.edu/rhumj/vol4/iss1/3
[5] https://www.docdroid.net/l1zAqRl/primepair-pdf
```

```md
# Определение k из 9 квадрат
### Info type
1_Main
### Keywords
~КвадратыИз9_1Определение, ~квадраты из 9, ~магические квадраты 3 на 3, ~квадратный квадрат
### Text
К данной проблеме зачастую подходят так: определим $k$ из 9 квадрат как магический квадрат 3 × 3, в котором $k$ чисел являются квадратами натуральных чисел.
```

```md
# Структура исследования квадратов 4 из 9
### Info type
2_N_of_Nine
### Keywords
~КвадратыИз9_2Структура4, ~квадраты из 9, ~квадраты 4 из 9, ~диофантовы уравнения, ~квадрики
### Text
В своём исследовании я структурирую данный подход, доказывая, что все возможные квадраты 4 из 9 требуют решения в точности одной квадрики (диофантового уравнения определённого вида), для каждого вида 4 из 9 эта квадрика своя (Рисунок 1), однако все их можно решить используя общеизвестный метод через рациональную параметризацию окружности [6].

**Ссылка:**
[6] https://en.m.wikipedia.org/wiki/Diophantine_equation
```

```md
# Определение квадратов 5 из 9
### Info type
2_N_of_Nine
### Keywords
~КвадратыИз9_3Определение5, ~квадраты из 9, ~квадраты 5 из 9, ~склейки
### Text
Квадраты 5 из 9 затем определяются как склейки двух вариантов 4 из 9 (~~КвадратыИз9_2Структура4) (Выбираются наиболее «удобные» уравнения по принципу красный > жёлтый > голубой > остальные, где «>» означает «удобнее»).
```

```md
# Параметризация красно-красных и красно-желтых квадратов
### Info type
2_N_of_Nine
### Keywords
~КвадратыИз9_4Параметризация, ~квадраты из 9, ~красно-красные квадраты, ~красно-желтые квадраты, ~параметризация
### Text
Мной получены параметризации всех «красно-красных» квадратов и большинства «красно-жёлтых», причём данные параметризации являются сюръекцией, т.е. покрывают всё множество таких квадратов (доказательства есть, но их нужно найти).
```

```md
# Подход к квадратам 6 из 9
### Info type
3_tfmn
### Keywords
~КвадратыИз9_5Подход6, ~квадраты из 9, ~квадраты 6 из 9, ~диофантовы уравнения
### Text
Для квадратов 6 из 9 подход похожий, однако концентрируемся только на тех квадратах, для которых требуется решать систему из трёх уравнений вида $a^2 + b^2 = 2c^2$.
```

```md
# Связь с конгруэнтными числами
### Info type
3_tfmn
### Keywords
~tfmn1Связь, ~конгруэнтные числа, ~tfmn-функция, ~квадраты из 9
### Text
Данное уравнение естественным образом предполагает работу с конгруэнтными числами (функции fmn и tfmn из основного документа) [8, 7] [9, 10 эти прочитать полностью пока не успел, но собираюсь]. О них собираюсь написать в следующем отчёте.

**Ссылки:**
[7] https://en.wikipedia.org/wiki/Congruum
[8] https://en.wikipedia.org/wiki/Congruent_number
[9] https://kconrad.math.uconn.edu/blurbs/ugradnumthy/congnumber.pdf
[10] https://mathstats.uncg.edu/sites/yasaki/publications/debbie-white-congruent-numbers-2018.pdf
```

```md
# Параметризация для 4/9 и 5/9
### Info type
2_N_of_Nine
### Keywords
~КвадратыИз9_6Визуализация, ~квадраты из 9, ~квадраты 4 из 9, ~квадраты 5 из 9, ~визуализация
### Text
Есть интерактивная визуализация для 4/9 и 5/9 – в папке web нужно открыть папку New и в ней файл index.html. В открывшемся интерфейсе в браузере можно посмотреть, как определяются квадраты различных типов. Если открыть просто web/index.html, можно посмотреть 6/9.
```

```md
# Источники
### Info type
6_Related_Works
### Keywords
~Литература0Список, ~источники
### Text
1. Гарднер М. Математические головоломки и развлечения / пер. с англ. Ю. А. Данилова ; под ред. Я. А. Смородинского. - 2-е изд., испр. и доп. - М.: Мир, 1999.
2. М. М. Постников, "Магические квадраты", М. Наука, 1964.
3. http://www.multimagie.com/
4. Rabern, Landon W. (2003) "Properties of Magic Squares of Squares," Rose-Hulman Undergraduate Mathematics Journal: Vol. 4: Iss. 1, Article 3. Available at: https://scholar.rose-hulman.edu/rhumj/vol4/iss1/3
5. https://www.docdroid.net/l1zAqRl/primepair-pdf
6. https://en.m.wikipedia.org/wiki/Diophantine_equation
7. https://en.wikipedia.org/wiki/Congruum
8. https://en.wikipedia.org/wiki/Congruent_number
9. https://kconrad.math.uconn.edu/blurbs/ugradnumthy/congnumber.pdf
10. https://mathstats.uncg.edu/sites/yasaki/publications/debbie-white-congruent-numbers-2018.pdf
```


```md
# Красные квадраты (dir-квадраты) - Определение и форма
### Info type
2_N_of_Nine
### Keywords
~Квадраты4Из9ОпределениеКрасные, ~красные квадраты, ~dir-квадраты, ~определение, ~формула, ~OX-нотация, ~ABCD-нотация
### Text
Красные квадраты, также известные как dir-квадраты, генерируются с использованием следующей формулы, где a, b, c, d - параметры:
'''
[C, E, G, A] = red(a, b, c, d)
''', где функция `red` определена как:
'''javascript
function red(a, b, c, d) {
    [a, b, c, d] = [a, b, c, d].map(elem => BigInt(elem))
    let ab = a * b;
    let a_b = a * a - b * b;
    let r1 = (2n * ab - a_b) * c;
    let r2 = (a * a + b * b) * c;
    let r3 = (2n * ab + a_b) * c;
    return [r1 * r1, r2 * r2, r3 * r3, d * d]
}
'''.

**OX-нотация:**
* Тип 1:
'''
XOX
OXO
XOO
'''
* Тип 2:
'''
OXO
XXX
OOO
'''
* Тип 3:
'''
XXO
OXO
OOX
'''
* Тип 4:
'''
OXO
XXO
OOX
'''
* Тип 5:
'''
XXO
OXO
OXO
'''
* Тип 6:
'''
OXO
XOX
XOO
'''
* Тип 7:
'''
XXO
XOO
OOX
'''

**ABCD-нотация (пример для первого типа):**
E+x = E
E-x+y = A - E
E-y = G - E
```

```md
# Желтые квадраты (квадраты Брахмагупты) - Определение и форма
### Info type
2_N_of_Nine
### Keywords
~Квадраты4Из9ОпределениеЖелтые, ~желтые квадраты, ~квадраты Брахмагупты, ~определение, ~формула, ~OX-нотация, ~ABCD-нотация
### Text
Желтые квадраты, также известные как квадраты Брахмагупты, генерируются с использованием следующей формулы, где a, b, c, d - параметры:
'''
[A, C, E, H] = yellow(a, b, c, d);
''', где функция `yellow` определена как:
'''javascript
function yellow(a, b, c, d) {
    [a, b, c, d] = [a, b, c, d].map(elem => BigInt(elem))
    return [
        a * c + b * d,
        a * d - b * c,
        a * c - b * d,
        a * d + b * c
    ].map(elem => elem * elem)
}
'''.

**OX-нотация:**
* Тип 1:
'''
XOX
OXO
OXO
'''
* Тип 2:
'''
XOX
XXO
OOO
'''
* Тип 3:
'''
OXO
XOX
OXO
'''
* Тип 4:
'''
XOX
OOO
XOX
'''
* Тип 5:
'''
XXO
OOX
OOX
'''
* Тип 6:
'''
XXO
OOO
OXX
'''

**ABCD-нотация (пример для первого типа):**
E+x = E
E-x+y = A - E
E-y = E - C
```

```md
# Голубые квадраты (квадраты Двахмагупты) - Определение и форма
### Info type
2_N_of_Nine
### Keywords
~Квадраты4Из9ОпределениеГолубые, ~голубые квадраты, ~квадраты Двахмагупты, ~определение, ~формула, ~OX-нотация, ~ABCD-нотация
### Text
Голубые квадраты, также известные как квадраты Двахмагупты, генерируются с использованием следующей формулы, где a, b, c, d - параметры:
'''
[E, C, B, D] = blue(a, b, c, d);
''', где функция `blue` определена как:
'''javascript
function blue(a, b, c, d) {
    [a, b, c, d] = [a, b, c, d].map(elem => BigInt(elem));
    return [
        a * c + b * d,
        a * c - b * d,
        a * d + 2n * b * c,
        a * d - 2n * b * c
    ].map(elem => elem * elem)
}
'''.

**OX-нотация:**
* Тип 1:
'''
OXX
XXO
OOO
'''
* Тип 2:
'''
XOX
OOX
XOO
'''
* Тип 3:
'''
XXO
XOX
OOO
'''
* Тип 4:
'''
XOX
XOX
OOO
'''

**ABCD-нотация (пример для первого типа):**
E+x = E
E-x+y = C - D
E-y = E - C
```

```md
# Коричневые квадраты - Определение и форма
### Info type
2_N_of_Nine
### Keywords
~Квадраты4Из9ОпределениеКоричневые, ~коричневые квадраты, ~определение, ~формула, ~OX-нотация, ~ABCD-нотация
### Text
Коричневые квадраты генерируются с использованием следующей формулы, где a, b, c, d - параметры:
'''
[A, B, G, C] = brown(a, b, c, d);
''', где функция `brown` определена как:
'''javascript
function brown(a, b, c, d) {
    [a, b, c, d] = [a, b, c, d].map(elem => BigInt(elem));
    let [A, B, C, D] = [a, b, c, d].map(elem => elem * elem)
    return [
        -2n * (C * D) + 2n * (A * D) - 4n * (a * c * D) - 3n * (B * C) + 6n * (b * d * C),
        2n * (C * D) - 2n * (A * D) - 4n * (a * c * D) - 3n * (B * C) + 6n * (b * d * a * c),
        2n * (C * D) + 2n * (A * D) + 3n * (B * C) - 4n * (b * d * C) - 4n * (b * d * a * c),
        2n * (C * D) + 2n * (A * D) - 3n * (B * C)
    ].map(elem => elem * elem)
}
'''.

**OX-нотация:**
* Тип 1:
'''
XXX
OOO
XOO
'''
* Тип 2:
'''
XXX
OOO
OXO
'''

**ABCD-нотация (пример для первого типа):**
E+x = (G + C) / 2n
E-x+y = G - B
E-y = (G - C) / 2n
```

```md
# Зеленые квадраты - Определение и форма
### Info type
2_N_of_Nine
### Keywords
~Квадраты4Из9ОпределениеЗеленые, ~зеленые квадраты, ~определение, ~формула, ~OX-нотация, ~ABCD-нотация
### Text
Зеленые квадраты генерируются с использованием следующей формулы, где a, b, c, d - параметры:
'''
[A, B, C, E] = green(a, b, c, d);
''', где функция `green` определена как:
'''javascript
function green(a, b, c, d) {
    [a, b, c, d] = [a, b, c, d].map(elem => BigInt(elem));
    let [A, B, C, D] = [a, b, c, d].map(elem => elem * elem)
    return [
        A + B - C - D + 2n * (a * c - a * d + b * c + b * d),
        A - B + C - D + 2n * (a * d - a * b + b * c + c * d),
        A - B - C + D + 2n * (a * b - a * c + b * d + c * d),
        A + B + C + D
    ].map(elem => elem * elem)
}
'''.

**OX-нотация:**
'''
XXX
OXO
OOO
'''

**ABCD-нотация:**
E+x = A - E
E-x+y = B - C
E-y = E - C
```

```md
# Темно-серые квадраты - Определение и форма
### Info type
2_N_of_Nine
### Keywords
~Квадраты4Из9ОпределениеТемноСерые, ~темно-серые квадраты, ~определение, ~формула, ~OX-нотация, ~ABCD-нотация
### Text
Темно-серые квадраты генерируются с использованием следующей формулы, где a, b, c, d - параметры:
'''
[A, B, D, E] = darkgray(a, b, c, d);
''', где функция `darkgray` определена как:
'''javascript
function darkgray(a, b, c, d) {
    [a, b, c, d] = [a, b, c, d].map(elem => BigInt(elem));
    let [A, B, C, D] = [a, b, c, d].map(elem => elem * elem)
    return [
        -2n * (C * D) + (A * D) - 2n * (a * c * D) + (B * C) - 2n * (b * d * C),
        2n * (C * D) - (A * D) - 4n * (a * c * D) + (B * C) - 2n * (b * d * a * c),
        2n * (C * D) + (A * D) - (B * C) - 4n * (b * d * C) - 2n * (b * d * a * c),
        2n * (C * D) + (A * D) + (B * C)
    ].map(elem => elem * elem)
}
'''.

**OX-нотация:**
'''
XXO
XXO
OOO
'''

**ABCD-нотация:**
E+x = A - E
E-x+y = C - D
E-y = (B - D) / 2n
```

```md
# Светло-серые квадраты - Определение и форма
### Info type
2_N_of_Nine
### Keywords
~Квадраты4Из9ОпределениеСветлоСерые, ~светло-серые квадраты, ~определение, ~формула, ~OX-нотация, ~ABCD-нотация
### Text
Светло-серые квадраты генерируются с использованием следующей формулы, где a, b, c, d - параметры:
'''
[A, D, C, B] = lightgray(a, b, c, d);
''', где функция `lightgray` определена как:
'''javascript
function lightgray(a, b, c, d) {
    [a, b, c, d] = [a, b, c, d].map(elem => BigInt(elem));
    let [A, B, C, D] = [a, b, c, d].map(elem => elem * elem)
    return [
        -2n * (C * D) + 3n * (A * D) - 6n * (a * c * D) - 4n * (B * C) + 8n * (b * d * C),
        2n * (C * D) - 3n * (A * D) - 4n * (a * c * D) - 4n * (B * C) + 8n * (b * d * a * c),
        2n * (C * D) + 3n * (A * D) + 4n * (B * C) - 4n * (b * d * C) - 6n * (b * d * a * c),
        2n * (C * D) + 3n * (A * D) - 4n * (B * C)
    ].map(elem => elem * elem)
}
'''.

**OX-нотация:**
'''
XXX
XOO
OOO
'''

**ABCD-нотация:**
E+x = (A + B + C) / 3n
E-x+y = C - D
E-y = (B - D) / 2n
```

```md
# Красно-красные квадраты - Определение и форма
### Info type
2_N_of_Nine
### Keywords
~Квадраты5Из9ОпределениеКрасноКрасные, ~красно-красные квадраты, ~определение, ~формула, ~OX-нотация, ~ABCD-нотация
### Text
Красно-красные квадраты генерируются с использованием следующих формул, где a, b, c, d - параметры:

**Тип 1:**
'''javascript
function redRed(a, b, c, d) {
    let k1 = a * a + b * b;
    let k2 = c * c + d * d;
    let [A, _, J, __] = red(a, b, k2, 0);
    let [B, E, H, ___] = red(c, d, k1, 0);
    return [E, A, J, B, H];
}
'''
**OX-нотация:**
'''
XOX
OXO
XOX
'''
**ABCD-нотация:**
E+x = E
E-x+y = A
E-y = J

**Тип 2:**
'''javascript
function redRed2(a, b, c, d) {
    let k1 = a * a - b * b + 2 * a * b;
    let k2 = c * c - d * d + 2 * c * d;
    let [_, J, B, __] = red(b, a, k2, 0);
    let [D, E, F, ___] = red(d, c, k1, 0);
    return [D, E, J, F, B];
}
'''
**OX-нотация:**
'''
OXO
XXX
OXO
'''
**ABCD-нотация:**
E+x = E
E-x+y = D
E-y = J

**Тип 3:**
'''javascript
function redRed3(a, b, c, d) {
    let k1 = a * a - b * b + 2 * a * b;
    let k2 = c * c + d * d;
    let [A, E, _, __] = red(a, b, k2, 0);
    let [D, J, B, ___] = red(c, d, k1, 0);
    return [J, E, A, D, B];
}
'''
**OX-нотация:**
'''
XXO
OXO
OXX
'''
**ABCD-нотация:**
E+x = E
E-x+y = A
E-y = J

**Тип 4:**
'''javascript
function bdefj(a, b, c, d) {
    let [D, E, J, F, B] = redRed2(a, b, c, d);
    return [E, E - J, B - J];
}
'''
**OX-нотация:**
'''
OXO
XXX
OOX
'''
**ABCD-нотация:**
E+x = E - J
E-x+y = D
E-y = B - J

**Тип 5:**
'''javascript
function bdfgj(a, b, c, d) {
    let [B, G, J, F, D] = redRed2(a, b, c, d);
    if (D % 2n !== F % 2n) {
        [B, G, J, F, D] = [B, G, J, F, D].map(elem => elem * 4n);
    }
    return [(D + F) / 2n, G - B, B - J];
}
'''
**OX-нотация:**
'''
OXO
XOX
XOX
'''
**ABCD-нотация:**
E+x = G - B
E-x+y = B
E-y = B - J

**Тип 6:**
'''javascript
function abdej(a, b, c, d) {
    let [J, E, A, B, D] = redRed3(a, b, c, d);
    return [E, E - J, B - J];
}
'''
**OX-нотация:**
'''
XXO
XXO
OOX
'''
**ABCD-нотация:**
E+x = E - J
E-x+y = A
E-y = B - J
```

```md
# Красно-желтые квадраты - Определение и форма
### Info type
2_N_of_Nine
### Keywords
~Квадраты5Из9ОпределениеКрасноЖелтые, ~красно-желтые квадраты, ~определение, ~формула, ~OX-нотация, ~ABCD-нотация
### Text
Красно-желтые квадраты генерируются с использованием следующих формул, где a, b, c, d - параметры:

**Тип 1:**
'''javascript
function bdfhj(a, b, c, d) {
    let [J, B, H, D, F] = redYellow(b, a, c, d);
    if (F % 2n !== D % 2n) {
        [J, B, H, D, F] = [J, B, H, D, F].map(elem => elem * 4n);
    }
    return [(D + F) / 2n, (F - B) / 2n, B - J];
}
'''
**OX-нотация:**
'''
OXO
XOX
OXX
'''
**ABCD-нотация:**
E+x = (F - B) / 2n
E-x+y = B
E-y = B - J

**Тип 2:**
'''javascript
function abdfj(a, b, c, d) {
    let [D, J, F, B, A] = redYellow2(b, a, c, d);
    if (F % 2n !== D % 2n) {
        [D, J, F, B, A] = [D, J, F, B, A].map(elem => elem * 4n);
    }
    return [(D + F) / 2n, (F - B) / 2n, B - J];
}
'''
**OX-нотация:**
'''
XXO
XOX
OOX
'''
**ABCD-нотация:**
E+x = (F - B) / 2n
E-x+y = J
E-y = B - J

**Тип 3:**
'''javascript
function acehj(a, b, c, d) {
    let [A, E, C, J, H] = redYellow2(b, a, c, d);
    return [E, A - E, E - C];
}
'''
**OX-нотация:**
'''
XOX
OXO
OXX
'''
**ABCD-нотация:**
E+x = A - E
E-x+y = E
E-y = E - C

**Тип 4:**
'''javascript
function acdeg(a, b, c, d) {
    return [1, 0, 0];
}
'''
**OX-нотация:**
'''
XOX
XXO
XOO
'''
**ABCD-нотация:**
E+x = 0
E-x+y = 1
E-y = 0

**Тип 5:**
'''javascript
function abceh(a, b, c, d) {
    return [1, 0, 0];
}
'''
**OX-нотация:**
'''
XXX
OXO
OXO
'''
**ABCD-нотация:**
E+x = 0
E-x+y = 1
E-y = 0

**Тип 6:**
'''javascript
function acdef(a, b, c, d) {
    let [F, E, C, D, A] = redYellow2(b, a, c, d);
    return [E, A - E, E - C];
}
'''
**OX-нотация:**
'''
XOX
XXX
OOO
'''
**ABCD-нотация:**
E+x = A - E
E-x+y = E
E-y = E - C

**Тип 7:**
'''javascript
function abefj(a, b, c, d) {
    let [E, A, B, J, F] = redYellow(b, a, c, d);
    return [E, A - E, B - J];
}
'''
**OX-нотация:**
'''
XXO
OXX
OOX
'''
**ABCD-нотация:**
E+x = A - E
E-x+y = E
E-y = B - J

**Тип 8:**
'''javascript
function abfgj(a, b, c, d) {
    let [G, B, A, F, J] = redYellow(b, a, c, d);
    if (A % 2n !== J % 2n) {
        [G, B, A, F, J] = [G, B, A, F, J].map(elem => elem * 4n);
    }
    return [(A + J) / 2n, (A - J) / 2n, B - J];
}
'''
**OX-нотация:**
'''
XXO
OOX
XOX
'''
**ABCD-нотация:**
E+x = (A - J) / 2n
E-x+y = B
E-y = B - J
```
